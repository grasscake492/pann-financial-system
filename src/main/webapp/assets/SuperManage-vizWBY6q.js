import{hi as jt,r as i,hl as A,hI as q,f as zt,hn as Ot,ho as a,hp as Kt,hq as t,hs as o,ht as d,hS as B,hr as c,hU as C,hu as I,hJ as g,hK as k,hv as n,b as _,hy as j,g3 as r,hW as wt,hQ as Qt,hZ as Jt}from"./index-CAl9Fkbs.js";import{P as Wt}from"./PageBackground2-Ck1v3nqa.js";import{a as v}from"./Navbar-kC0yHLwy.js";import{a as X,e as Zt,b as Gt}from"./royalty-DVaQoL-r.js";import{c as Ht,g as Xt}from"./proxy-Vuha4EIT.js";import{a as te,r as ee,u as ht}from"./feedback-CbatGfMo.js";import{F as le,a as se}from"./feedbackStatus-DqnZOqTf.js";const ne={class:"top-tabs"},ae={key:0,class:"tab-content"},oe={class:"query-form"},re={class:"content-table"},ue={key:0},ie={key:1},de={class:"feedback-filter"},pe={class:"feedback-item-list"},ce={key:0,class:"empty-tip"},me={class:"feedback-header"},ve={class:"feedback-id"},_e={class:"feedback-content"},be={class:"feedback-actions"},fe=["onClick"],ye=["onClick"],ge={key:0,class:"pagination"},ke=["disabled"],we=["disabled"],he={key:1,class:"dialog-mask"},De={class:"dialog-content"},Ae={key:2,class:"dialog-mask"},Ce={class:"dialog-content"},$e={key:2,class:"tab-content"},Ue={class:"content-table"},Ie={key:0},Se={key:0,class:"role-tag super-admin"},Le={key:1,class:"role-tag dept-admin"},Fe={key:2,class:"role-tag normal-user"},Ve={class:"op-btn-group"},xe=["onClick"],Me=["onClick"],Ee={key:0,class:"dialog-mask"},Ne={class:"dialog-content"},Te={class:"form-row"},Re={class:"form-row"},Pe={class:"form-row"},Ye={class:"dialog-btns"},qe={key:1,class:"dialog-mask"},Be={class:"dialog-content"},je={class:"form-row"},ze={class:"form-row"},Oe={class:"form-row"},Ke={class:"dialog-btns"},Qe={key:3,class:"tab-content"},Je={class:"form-row",style:{"align-items":"center",gap:"20px","margin-bottom":"20px","flex-wrap":"wrap"}},We={style:{display:"flex","align-items":"center",gap:"10px"}},Ze=["value"],Ge=["value"],He={class:"dept-section"},Xe={class:"content-table"},tl={key:0},el={class:"total-row bold"},ll={class:"dept-section"},sl={class:"content-table"},nl={key:0},al={class:"total-row"},ol={class:"dept-section"},rl={class:"content-table"},ul={key:0},il={class:"total-row"},dl={class:"total-row"},pl={class:"total-row bold"},cl={key:4,class:"tab-content"},ml={class:"form-row"},vl=["disabled"],_l={class:"content-table"},bl={key:0},fl={class:"content-table"},yl={key:0},gl={key:0},kl={class:"total-row"},wl={class:"content-table"},hl={key:0},Dl={key:0},Al={class:"total-row"},Cl={class:"content-table"},$l={key:0},Ul={key:0},Il={class:"total-row"},Sl={key:5,class:"dialog-mask"},Ll={class:"dialog-content"},Fl={class:"form-row"},Vl={class:"form-row"},xl={class:"form-row"},Ml={class:"form-row"},El={class:"dialog-btns"},Nl={__name:"SuperManage",setup(Tl){const w=i("query"),E={1:"新闻部",2:"编辑部",3:"运营部",news:1,edit:2,operation:3},tt=async s=>{switch(w.value=s,s){case"query":await O();break;case"manage":await Q(),await ft();break;case"user":await pt();break;case"summary":break;case"account":await Q();break;case"feedback":await K();break}},$=A({month:"",deptId:"",article_title:""}),et=i([]),lt=i(!1),z=i(!1),b=A({record_id:"",created_at:"",article_title:"",real_names:[],fee_amount:0,deptId:""}),O=async()=>{try{const s=new Date().getFullYear(),e={statistical_month:$.month?`${s}-${$.month.padStart(2,"0")}`:"",department_id:E[$.deptId]||"",article_title:$.article_title},l=await X(e);if(l.res_code==="0000"){const u=l.data?.list||[];et.value=u.map(p=>{const h=p.real_names?p.real_names.join(","):"未知人员",D=p.fee_amount||0;return{...p,userAmountDetail:`${h}(${D}元)`,deptName:E[p.department_id]||"未知部门"}})}else r.error(`获取任务列表失败：${l.res_msg}`)}catch{r.error("网络异常，获取任务列表失败")}},Dt=async()=>{if(!b.article_title||!b.deptId||b.fee_amount<=0){r.warning("请填写任务名称、选择部门并输入有效金额");return}try{const s={record_id:b.record_id,article_title:b.article_title,real_names:b.real_names,fee_amount:b.fee_amount,department_id:E[b.deptId]},e=await Gt(s);e.res_code==="0000"?(r.success(z.value?"新增任务成功":"编辑任务成功"),lt.value=!1,await O()):r.error(`${z.value?"新增":"编辑"}任务失败：${e.res_msg}`)}catch{r.error(`网络异常，${z.value?"新增":"编辑"}任务失败`)}},F=i([]),At=i(0),S=i(1),st=i(2),V=i(""),x=i(""),nt=A({page:1,size:100,status:""}),at=i(!1),L=i(""),M=A({reply_content:""}),ot=i(!1),N=A({status:"pending"}),rt=q(()=>{let s=[...F.value];if(V.value&&(s=s.filter(u=>u.created_at?.split("-")[1]===V.value.padStart(2,"0"))),x.value){const u=x.value.trim().toLowerCase();s=s.filter(p=>p.real_name?.toLowerCase().includes(u))}const e=(S.value-1)*st.value,l=e+st.value;return s.slice(e,l)}),ut=q(()=>{let s=[...F.value];if(V.value&&(s=s.filter(e=>e.created_at?.split("-")[1]===V.value.padStart(2,"0"))),x.value){const e=x.value.trim().toLowerCase();s=s.filter(l=>l.real_name?.toLowerCase().includes(e))}return Math.ceil(s.length/st.value)||1}),K=async()=>{try{const s=await te(nt);s.res_code==="0000"?(F.value=s.data.list||[],At.value=s.data.total||0,S.value=1):(r.error(`查询失败：${s.res_msg}`),F.value=[])}catch{r.error("网络异常，查询反馈失败"),F.value=[]}},Ct=()=>{S.value=1},vt=s=>{s<1||s>ut.value||(S.value=s)},$t=s=>{L.value=s,M.reply_content="",at.value=!0},_t=()=>{at.value=!1,L.value="",M.reply_content=""},Ut=async()=>{if(!M.reply_content.trim()){r.warning("请输入回复内容");return}try{const s=await ee(L.value,{reply_content:M.reply_content});s.res_code==="0000"?(r.success("回复成功"),_t(),await ht(L.value,{status:"replied"}),await K()):r.error(`回复失败：${s.res_msg}`)}catch{r.error("网络异常，回复失败")}},It=s=>{L.value=s;const e=F.value.find(l=>l.feedback_id===s);e&&(N.status=e.status||"pending"),ot.value=!0},bt=()=>{ot.value=!1,L.value="",N.status="pending"},St=async()=>{try{const s=await ht(L.value,{status:N.status});s.res_code==="0000"?(r.success("状态更新成功"),bt(),await K()):r.error(`状态更新失败：${s.res_msg}`)}catch{r.error("网络异常，状态更新失败")}};A({month:"",feeRecordId:"",proxyUserId:"",beProxyUserId:"",deptId:"",amount:0});const it=i([]),U=i([]),Lt=i([]),Q=async()=>{try{const s=await wt({page:1,size:999});s.res_code==="0000"?(U.value=s.data?.list||[],U.value.length>0):r.error(`加载成员列表失败：${s.res_msg}`)}catch{r.error("网络异常，加载成员列表失败")}},Ft=async()=>{try{const s=await X({page:1,size:100});s.res_code==="0000"?Lt.value=s.data?.list||[]:r.error(`加载稿费记录失败：${s.res_msg}`)}catch{r.error("网络异常，加载稿费记录失败")}},ft=async()=>{try{const s=await Xt();if(s.res_code==="0000"){const e=s.data?.list||[];it.value=e.map(l=>{const u=U.value.find(D=>D.user_id==l.proxy_user_id)?.real_name||"未知用户",p=U.value.find(D=>D.user_id==l.original_user_id)?.real_name||"未知用户",h=E[l.department_id]||"未知部门";return{...l,proxyUser:u,beProxyUser:p,deptName:h}})}else r.error(`获取代领列表失败：${s.res_msg}`)}catch{r.error("网络异常，获取代领列表失败")}};i(!1),A({proxy_id:"",proxy_user_id:"",original_user_id:"",department_id:"",proxy_month:"",fee_record_id:"",article_title:"",fee_amount:0,description:""});const Vt=async()=>{await Q(),await Ft(),await ft()};zt(()=>{console.log("进入系统管理员页面，组件挂载，开始初始化数据"),Vt(),gt()});const dt=i(!1),J=i(!1),f=A({userId:"",real_name:"",student_number:"",email:"",created_at:"",deptId:""}),W=i(!1),m=A({user_id:"",real_name:"",is_super_admin:!1,department_id:"",role:"普通成员"}),pt=async()=>{try{const s=await wt();s.res_code==="0000"?U.value=s.data.list||[]:r.error(`获取人员列表失败：${s.res_msg}`)}catch{r.error("网络异常，获取人员列表失败")}},xt=async()=>{if(!f.real_name||!f.created_at||!f.deptId){r.warning("请填写所有必填字段");return}try{const s=await Qt({user_id:f.userId,real_name:f.real_name,student_number:f.student_number,email:f.email,department_id:f.deptId,created_at:f.created_at});s.res_code==="0000"?(r.success(J.value?"新增成员成功":"编辑成员成功"),dt.value=!1,await pt()):r.error(`${J.value?"新增":"编辑"}成员失败：${s.res_msg}`)}catch{r.error(`网络异常，${J.value?"新增":"编辑"}成员失败`)}},Mt=s=>{m.user_id=s.user_id,m.real_name=s.real_name,m.is_super_admin=s.is_super_admin||!1,m.department_id=s.department_id||"",m.role=s.role||"普通成员",W.value=!0},Et=async()=>{if(!m.user_id||m.department_id===""){r.warning("请选择用户所属部门");return}try{const s={sign:"admin_sign_123456",user_id:m.user_id,is_super_admin:m.is_super_admin,department_id:m.department_id},e=await Jt(s);if(e.res_code==="0000"){r.success("角色权限修改成功"),W.value=!1;const l=U.value.findIndex(u=>u.user_id===m.user_id);l>-1&&(U.value[l]={...U.value[l],is_super_admin:m.is_super_admin,department_id:m.department_id,role:m.role})}else r.error(`角色修改失败：${e.res_msg}`)}catch(s){r.error("网络异常，角色修改失败"),console.error("修改用户角色报错：",s)}},Nt=async s=>{try{const e=await Ht(s);e.res_code==="0000"?(r.success("移除成员成功"),await pt()):r.error(`移除成员失败：${e.res_msg}`)}catch{r.error("网络异常，移除成员失败")}},Z=i(""),T=i(""),yt=i([]),ct=A({statistical_month:"",department_id:"",format:""}),Tt=()=>{const s=new Date().getFullYear(),e=s,l=s+3,u=[];for(let p=e;p<=l;p++)u.push(p);return u},gt=()=>{T.value="",yt.value=Array.from({length:12},(s,e)=>{const l=e+1;return{value:String(l).padStart(2,"0"),label:`${l}月`}})},Rt=()=>{Z.value&&T.value&&(ct.statistical_month=`${Z.value}-${T.value}`,Yt())},G=i([]),H=i([]),mt=i([]),R=q(()=>v(G.value.reduce((s,e)=>s+Number(e.fee_amount||0),0))),P=q(()=>v(H.value.reduce((s,e)=>s+Number(e.totalAmount),0))),Pt=q(()=>v(Number(R.value)+Number(P.value))),Yt=async()=>{if(!ct.statistical_month){r.warning("请选择统计月份（YYYY-MM）");return}try{const[s,e]=ct.statistical_month.split("-"),l=`${s}-${e}-01`,u=new Date(Number(s),Number(e),0).toISOString().split("T")[0],p=await X({startDate:l,endDate:u,page:1,size:100,department_id:1});if(p.res_code==="0000"){const h=p.data.list||[];G.value=h.map(y=>({...y,real_names:Array.isArray(y.real_names)?y.real_names.join(", "):y.real_names||"-"}));const D=await X({startDate:l,endDate:u,page:1,size:100,department_id:2});D.res_code==="0000"&&(H.value=D.data.list.map(y=>({...y,real_names:Array.isArray(y.real_names)?y.real_names.join(", "):y.real_names||"-"}))),qt([...h,...D.data?.list||[]])}else r.error(`获取汇总数据失败：${p.res_msg}`)}catch(s){console.error("获取汇总数据失败:",s),r.error("网络异常，获取汇总数据失败")}},qt=s=>{const e=new Map;s.forEach(l=>{const u=l.user_ids?.length||0;if(u!==0)for(let p=0;p<u;p++){const h=l.user_ids[p],D=l.real_names[p]||"未知";e.has(h)||e.set(h,{userId:h,real_name:D,newsAmount:0,editAmount:0,bigImgAmount:0,totalAmount:0});const y=e.get(h),kt=Number(l.fee_amount)/u;l.department_id===1&&(y.newsAmount+=kt),l.department_id===2&&(y.editAmount+=kt)}}),mt.value=Array.from(e.values()).map(l=>({...l,totalAmount:l.newsAmount+l.editAmount+l.bigImgAmount}))},Y=A({month:""});i([]);const Bt=async()=>{if(!Y.month){r.warning("请选择月份");return}const e=`${new Date().getFullYear()}-${Y.month}`;try{r.loading({message:"导出中...",duration:0});const l=await Zt({statistical_month:e,type:"proxy"});if(r.closeAll(),l.res_code==="0000"){const u=document.createElement("a");u.href=l.data.download_url,u.download=`代领调整后稿费_${e}.xlsx`,u.click(),r.success("导出成功")}else r.error(`导出失败：${l.res_msg}`)}catch(l){r.closeAll(),r.error("网络异常，导出失败"),console.error("做账数据导出失败：",l)}};return O(),Q(),(s,e)=>(a(),Ot(Wt,null,{"card-content":Kt(()=>[t("div",ne,[t("button",{class:B(["top-tab-btn",{active:w.value==="query"}]),onClick:e[0]||(e[0]=l=>tt("query"))}," 任务查询 ",2),t("button",{class:B(["top-tab-btn",{active:w.value==="feedback"}]),onClick:e[1]||(e[1]=()=>{w.value="feedback",K()})}," 查看反馈 ",2),t("button",{class:B(["top-tab-btn",{active:w.value==="user"}]),onClick:e[2]||(e[2]=l=>tt("user"))}," 人员管理 ",2),t("button",{class:B(["top-tab-btn",{active:w.value==="summary"}]),onClick:e[3]||(e[3]=l=>tt("summary"))}," 稿费汇总 ",2)]),w.value==="query"?(a(),o("div",ae,[t("div",oe,[e[33]||(e[33]=t("label",null,"选择月份:",-1)),c(t("select",{class:"form-select","onUpdate:modelValue":e[4]||(e[4]=l=>$.month=l)},[...e[31]||(e[31]=[t("option",{value:""},"全部",-1),t("option",{value:"01"},"1月",-1),t("option",{value:"02"},"2月",-1),t("option",{value:"03"},"3月",-1),t("option",{value:"04"},"4月",-1),t("option",{value:"05"},"5月",-1),t("option",{value:"06"},"6月",-1),t("option",{value:"07"},"7月",-1),t("option",{value:"08"},"8月",-1),t("option",{value:"09"},"9月",-1),t("option",{value:"10"},"10月",-1),t("option",{value:"11"},"11月",-1),t("option",{value:"12"},"12月",-1)])],512),[[C,$.month]]),e[34]||(e[34]=t("label",null,"选择部门:",-1)),c(t("select",{class:"form-select","onUpdate:modelValue":e[5]||(e[5]=l=>$.deptId=l)},[...e[32]||(e[32]=[t("option",{value:""},"全部",-1),t("option",{value:"news"},"新闻部",-1),t("option",{value:"edit"},"编辑部",-1),t("option",{value:"operation"},"运营部",-1)])],512),[[C,$.deptId]]),e[35]||(e[35]=t("label",null,"任务名称:",-1)),c(t("input",{type:"text",placeholder:"输入任务名称查询",class:"form-input","onUpdate:modelValue":e[6]||(e[6]=l=>$.article_title=l)},null,512),[[I,$.article_title]]),t("button",{class:"query-btn",onClick:O},"查询")]),t("table",re,[e[37]||(e[37]=t("thead",null,[t("tr",null,[t("th",null,"日期"),t("th",null,"任务名称"),t("th",null,"参与人"),t("th",null,"金额详情"),t("th",null,"部门")])],-1)),t("tbody",null,[et.value.length===0?(a(),o("tr",ue,[...e[36]||(e[36]=[t("td",{colspan:"5",class:"empty-tip"},"暂无任务记录",-1)])])):d("",!0),(a(!0),o(g,null,k(et.value,l=>(a(),o("tr",{key:l.record_id},[t("td",null,n(l.created_at),1),t("td",null,n(l.article_title),1),t("td",null,n(l.real_names?.join(", ")||"-"),1),t("td",null,n(l.fee_amount),1),t("td",null,n(l.deptName),1)]))),128))])])])):d("",!0),w.value==="feedback"?(a(),o("div",ie,[t("div",de,[e[40]||(e[40]=t("label",null,"反馈状态:",-1)),c(t("select",{class:"form-select","onUpdate:modelValue":e[7]||(e[7]=l=>nt.status=l)},[...e[38]||(e[38]=[t("option",{value:""},"全部",-1),t("option",{value:"pending"},"待处理",-1),t("option",{value:"replied"},"已回复",-1)])],512),[[C,nt.status]]),e[41]||(e[41]=t("label",null,"月份:",-1)),c(t("select",{class:"form-select","onUpdate:modelValue":e[8]||(e[8]=l=>V.value=l)},[...e[39]||(e[39]=[t("option",{value:""},"全部",-1),t("option",{value:"1"},"1月",-1)])],512),[[C,V.value]]),e[42]||(e[42]=t("label",null,"用户姓名:",-1)),c(t("input",{type:"text",placeholder:"输入姓名模糊查询",class:"form-input","onUpdate:modelValue":e[9]||(e[9]=l=>x.value=l)},null,512),[[I,x.value]]),t("button",{class:"query-btn",onClick:Ct},"查询")]),t("div",pe,[rt.value.length===0?(a(),o("div",ce,"暂无反馈数据")):d("",!0),(a(!0),o(g,null,k(rt.value,l=>(a(),o("div",{class:"feedback-item",key:l.feedback_id},[t("div",me,[t("span",ve,"反馈ID："+n(l.feedback_id),1),t("span",{class:B(["status-tag",_(le)[l.status]])},n(_(se)[l.status]),3)]),t("div",_e,[t("p",null,[e[43]||(e[43]=t("span",{class:"label"},"反馈用户：",-1)),j(n(l.real_name),1)]),t("p",null,[e[44]||(e[44]=t("span",{class:"label"},"反馈内容：",-1)),j(n(l.content),1)]),t("p",null,[e[45]||(e[45]=t("span",{class:"label"},"反馈时间：",-1)),j(n(l.created_at),1)]),t("p",null,[e[46]||(e[46]=t("span",{class:"label"},"回复时间：",-1)),j(n(l.replied_at||"未回复"),1)]),t("p",null,[e[47]||(e[47]=t("span",{class:"label"},"回复内容：",-1)),j(n(l.reply_content||"暂无回复"),1)])]),t("div",be,[t("button",{class:"op-btn reply-btn",onClick:u=>$t(l.feedback_id)},"回复",8,fe),t("button",{class:"op-btn status-btn",onClick:u=>It(l.feedback_id)},"改状态",8,ye)])]))),128))]),rt.value.length>0?(a(),o("div",ge,[t("button",{class:"page-btn",onClick:e[10]||(e[10]=l=>vt(S.value-1)),disabled:S.value<=1}," 上一页 ",8,ke),t("span",null,"第"+n(S.value)+"页 / 共"+n(ut.value)+"页",1),t("button",{class:"page-btn",onClick:e[11]||(e[11]=l=>vt(S.value+1)),disabled:S.value>=ut.value}," 下一页 ",8,we)])):d("",!0),at.value?(a(),o("div",he,[t("div",De,[t("h4",null,"回复反馈（ID: "+n(L.value)+"）",1),c(t("textarea",{placeholder:"请输入回复内容",class:"reply-textarea","onUpdate:modelValue":e[12]||(e[12]=l=>M.reply_content=l)},null,512),[[I,M.reply_content]]),t("div",{class:"dialog-btns"},[t("button",{class:"cancel-btn",onClick:_t},"取消"),t("button",{class:"confirm-btn",onClick:Ut},"提交回复")])])])):d("",!0),ot.value?(a(),o("div",Ae,[t("div",Ce,[t("h4",null,"更新反馈状态（ID: "+n(L.value)+"）",1),c(t("select",{class:"form-select","onUpdate:modelValue":e[13]||(e[13]=l=>N.status=l)},[...e[48]||(e[48]=[t("option",{value:"pending"},"待处理",-1),t("option",{value:"replied"},"已回复",-1)])],512),[[C,N.status]]),t("div",{class:"dialog-btns"},[t("button",{class:"cancel-btn",onClick:bt},"取消"),t("button",{class:"confirm-btn",onClick:St},"确认更新")])])])):d("",!0)])):d("",!0),w.value==="user"?(a(),o("div",$e,[e[60]||(e[60]=t("div",{class:"section-title"},[t("div",{class:"title-line"}),t("h3",null,"目前成员")],-1)),t("table",Ue,[e[50]||(e[50]=t("thead",null,[t("tr",null,[t("th",null,"真实姓名"),t("th",null,"学号"),t("th",null,"邮箱"),t("th",null,"所属部门"),t("th",null,"角色权限"),t("th",null,"操作")])],-1)),t("tbody",null,[U.value.length===0?(a(),o("tr",Ie,[...e[49]||(e[49]=[t("td",{colspan:"8",class:"empty-tip"},"暂无成员记录",-1)])])):d("",!0),(a(!0),o(g,null,k(U.value,l=>(a(),o("tr",{key:l.user_id},[t("td",null,n(l.real_name),1),t("td",null,n(l.student_number||"-"),1),t("td",null,n(l.email||"-"),1),t("td",null,n(E[l.department_id]||"未知部门"),1),t("td",null,[l.is_super_admin?(a(),o("span",Se,"系统管理员")):l.department_id&&l.department_id!==""?(a(),o("span",Le,"部门管理员")):(a(),o("span",Fe,"普通用户"))]),t("td",null,[t("div",Ve,[t("button",{class:"op-btn primary",onClick:u=>Mt(l)},"修改角色",8,xe),t("button",{class:"op-btn danger",onClick:u=>Nt(l.user_id)},"移除",8,Me)])])]))),128))])]),dt.value?(a(),o("div",Ee,[t("div",Ne,[t("h4",null,n(J.value?"新增成员":"编辑成员"),1),t("div",Te,[e[51]||(e[51]=t("label",null,"成员名称:",-1)),c(t("input",{type:"text",class:"form-input","onUpdate:modelValue":e[14]||(e[14]=l=>f.real_name=l),placeholder:"请输入真实姓名"},null,512),[[I,f.real_name]])]),t("div",Re,[e[52]||(e[52]=t("label",null,"学号:",-1)),c(t("input",{type:"text",class:"form-input","onUpdate:modelValue":e[15]||(e[15]=l=>f.student_number=l),placeholder:"请输入学号"},null,512),[[I,f.student_number]])]),t("div",Pe,[e[53]||(e[53]=t("label",null,"邮箱:",-1)),c(t("input",{type:"email",class:"form-input","onUpdate:modelValue":e[16]||(e[16]=l=>f.email=l),placeholder:"请输入邮箱"},null,512),[[I,f.email]])]),t("div",Ye,[t("button",{class:"cancel-btn",onClick:e[17]||(e[17]=l=>dt.value=!1)},"取消"),t("button",{class:"confirm-btn",onClick:xt},"确认")])])])):d("",!0),W.value?(a(),o("div",qe,[t("div",Be,[e[59]||(e[59]=t("h4",null,"修改用户角色权限",-1)),t("div",je,[e[54]||(e[54]=t("label",null,"用户姓名:",-1)),c(t("input",{type:"text",class:"form-input","onUpdate:modelValue":e[18]||(e[18]=l=>m.real_name=l),disabled:""},null,512),[[I,m.real_name]])]),t("div",ze,[e[56]||(e[56]=t("label",null,"所属部门:",-1)),c(t("select",{class:"form-input","onUpdate:modelValue":e[19]||(e[19]=l=>m.department_id=l)},[...e[55]||(e[55]=[t("option",{value:""},"请选择部门",-1),t("option",{value:"1"},"新闻部",-1),t("option",{value:"2"},"编辑部",-1),t("option",{value:"3"},"运营部",-1)])],512),[[C,m.department_id]])]),t("div",Oe,[e[58]||(e[58]=t("label",null,"用户角色:",-1)),c(t("select",{class:"form-input","onUpdate:modelValue":e[20]||(e[20]=l=>m.role=l)},[...e[57]||(e[57]=[t("option",{value:"部门管理员"},"部门管理员",-1),t("option",{value:"系统管理员"},"系统管理员",-1)])],512),[[C,m.role]])]),t("div",Ke,[t("button",{class:"cancel-btn",onClick:e[21]||(e[21]=l=>W.value=!1)},"取消"),t("button",{class:"confirm-btn",onClick:Et},"确认修改")])])])):d("",!0)])):d("",!0),w.value==="summary"?(a(),o("div",Qe,[e[79]||(e[79]=t("div",{class:"section-title"},[t("div",{class:"title-line"}),t("h3",null,"稿费汇总与导出")],-1)),t("div",Je,[t("div",We,[e[63]||(e[63]=t("label",null,"统计月份:",-1)),c(t("select",{class:"form-select","onUpdate:modelValue":e[22]||(e[22]=l=>Z.value=l),onChange:gt},[e[61]||(e[61]=t("option",{value:""},"请选择年份",-1)),(a(!0),o(g,null,k(Tt(),l=>(a(),o("option",{key:l,value:l},n(l)+"年 ",9,Ze))),128))],544),[[C,Z.value]]),c(t("select",{class:"form-select","onUpdate:modelValue":e[23]||(e[23]=l=>T.value=l),onChange:Rt},[e[62]||(e[62]=t("option",{value:""},"请选择月份",-1)),(a(!0),o(g,null,k(yt.value,l=>(a(),o("option",{key:l.value,value:l.value},n(l.label),9,Ge))),128))],544),[[C,T.value]])]),e[64]||(e[64]=t("div",{style:{display:"flex","align-items":"center"}},null,-1))]),t("div",He,[e[68]||(e[68]=t("label",null,"新闻部:",-1)),t("table",Xe,[e[66]||(e[66]=t("thead",null,[t("tr",null,[t("th",null,"日期"),t("th",null,"任务名称"),t("th",null,"拍摄人员"),t("th",null,"任务总金额")])],-1)),t("tbody",null,[G.value.length===0?(a(),o("tr",tl,[...e[65]||(e[65]=[t("td",{colspan:"4",class:"empty-tip"},"暂无新闻部稿费记录",-1)])])):d("",!0),(a(!0),o(g,null,k(G.value,l=>(a(),o("tr",{key:l.record_id},[t("td",null,n(l.created_at||"-"),1),t("td",null,n(l.article_title||"-"),1),t("td",null,n(l.real_names||"-"),1),t("td",null,n(_(v)(l.fee_amount))+"元",1)]))),128))])]),t("div",el,[e[67]||(e[67]=t("label",null,"新闻部总稿费:",-1)),t("span",null,n(R.value)+"元",1)])]),t("div",ll,[e[72]||(e[72]=t("label",null,"编辑部:",-1)),t("table",sl,[e[70]||(e[70]=t("thead",null,[t("tr",null,[t("th",null,"日期"),t("th",null,"任务名称"),t("th",null,"拍摄人员"),t("th",null,"任务总金额")])],-1)),t("tbody",null,[H.value.length===0?(a(),o("tr",nl,[...e[69]||(e[69]=[t("td",{colspan:"4",class:"empty-tip"},"暂无编辑部稿费记录",-1)])])):d("",!0),(a(!0),o(g,null,k(H.value,l=>(a(),o("tr",{key:l.projectId},[t("td",null,n(l.created_at)+"元",1),t("td",null,n(l.article_title),1),t("td",null,n(l.real_names),1),t("td",null,n(l.fee_amount)+"元",1)]))),128))])]),t("div",al,[e[71]||(e[71]=t("label",null,"编辑部总:",-1)),t("span",null,n(P.value)+"元",1)])]),t("div",ol,[e[78]||(e[78]=t("label",null,"稿费汇总:",-1)),t("table",rl,[e[74]||(e[74]=t("thead",null,[t("tr",null,[t("th",null,"姓名"),t("th",null,"新闻部稿费"),t("th",null,"编辑部稿费"),t("th",null,"大图稿费"),t("th",null,"总金额")])],-1)),t("tbody",null,[mt.value.length===0?(a(),o("tr",ul,[...e[73]||(e[73]=[t("td",{colspan:"5",class:"empty-tip"},"暂无汇总数据",-1)])])):d("",!0),(a(!0),o(g,null,k(mt.value,l=>(a(),o("tr",{key:l.userId},[t("td",null,n(l.real_name),1),t("td",null,n(l.newsAmount)+"元",1),t("td",null,n(l.editAmount)+"元",1),t("td",null,n(l.bigImgAmount)+"元",1),t("td",null,n(l.totalAmount)+"元",1)]))),128))])]),t("div",il,[e[75]||(e[75]=t("label",null,"新闻部总:",-1)),t("span",null,n(R.value)+"元",1)]),t("div",dl,[e[76]||(e[76]=t("label",null,"编辑部总:",-1)),t("span",null,n(P.value)+"元",1)]),t("div",pl,[e[77]||(e[77]=t("label",null,"平台总稿费:",-1)),t("span",null,n(Pt.value)+"元",1)])])])):d("",!0),w.value==="account"?(a(),o("div",cl,[e[93]||(e[93]=t("div",{class:"section-title"},[t("div",{class:"title-line"}),t("h3",null,"代领调整后稿费")],-1)),t("div",ml,[e[81]||(e[81]=t("label",null,"选择月份:",-1)),c(t("select",{class:"form-select","onUpdate:modelValue":e[24]||(e[24]=l=>Y.month=l),onChange:e[25]||(e[25]=(...l)=>s.fetchAllAccountData&&s.fetchAllAccountData(...l))},[...e[80]||(e[80]=[t("option",{value:""},"请选择",-1),t("option",{value:"01"},"1月",-1),t("option",{value:"02"},"2月",-1),t("option",{value:"03"},"3月",-1),t("option",{value:"04"},"4月",-1),t("option",{value:"05"},"5月",-1),t("option",{value:"06"},"6月",-1),t("option",{value:"07"},"7月",-1),t("option",{value:"08"},"8月",-1),t("option",{value:"09"},"9月",-1),t("option",{value:"10"},"10月",-1),t("option",{value:"11"},"11月",-1),t("option",{value:"12"},"12月",-1)])],544),[[C,Y.month]]),t("button",{class:"export-btn",onClick:Bt,disabled:!Y.month}," 导出本月做账数据 ",8,vl)]),t("table",_l,[e[83]||(e[83]=t("thead",null,[t("tr",null,[t("th",null,"代领人"),t("th",null,"被代领人"),t("th",null,"代领部门"),t("th",null,"代领金额"),t("th",null,"最终金额")])],-1)),t("tbody",null,[it.value.length===0?(a(),o("tr",bl,[...e[82]||(e[82]=[t("td",{colspan:"5",class:"empty-tip"},"暂无代领记录数据",-1)])])):d("",!0),(a(!0),o(g,null,k(it.value,l=>(a(),o("tr",{key:l.proxy_id},[t("td",null,n(l.proxy_user_name),1),t("td",null,n(l.original_user_name),1),t("td",null,n(l.department_name),1),t("td",null,n(_(v)(l.fee_amount)),1),t("td",null,n(_(v)(l.final_fee_amount)),1)]))),128))])]),e[94]||(e[94]=t("div",{class:"section-title mt-20"},[t("div",{class:"title-line"}),t("h3",null,"新闻部代领后")],-1)),t("table",fl,[e[86]||(e[86]=t("thead",null,[t("tr",null,[t("th",null,"日期"),t("th",null,"任务名称"),t("th",null,"拍摄人员"),t("th",null,"任务金额"),t("th",null,"总金额")])],-1)),t("tbody",null,[s.newsDeptList.length===0?(a(),o("tr",yl,[...e[84]||(e[84]=[t("td",{colspan:"5",class:"empty-tip"},"暂无新闻部代领后数据",-1)])])):d("",!0),(a(!0),o(g,null,k(s.newsDeptList,l=>(a(),o("tr",{key:l.record_id},[t("td",null,n(s.formatDate(l.created_at)),1),t("td",null,n(l.article_title),1),t("td",null,n(l.real_names.join(", ")),1),t("td",null,n(_(v)(l.fee_amount)),1),t("td",null,n(_(v)(R.value)),1)]))),128))]),s.newsDeptList.length>0?(a(),o("tfoot",gl,[t("tr",kl,[e[85]||(e[85]=t("td",{colspan:"4",align:"right"},"新闻部总计：",-1)),t("td",null,n(_(v)(R.value)),1)])])):d("",!0)]),e[95]||(e[95]=t("div",{class:"section-title mt-20"},[t("div",{class:"title-line"}),t("h3",null,"编辑部代领后")],-1)),t("table",wl,[e[89]||(e[89]=t("thead",null,[t("tr",null,[t("th",null,"项目"),t("th",null,"供图人"),t("th",null,"金额详情"),t("th",null,"总金额")])],-1)),t("tbody",null,[s.editDeptList.length===0?(a(),o("tr",hl,[...e[87]||(e[87]=[t("td",{colspan:"4",class:"empty-tip"},"暂无编辑部代领后数据",-1)])])):d("",!0),(a(!0),o(g,null,k(s.editDeptList,l=>(a(),o("tr",{key:l.record_id},[t("td",null,n(l.article_title),1),t("td",null,n(l.real_names.join(", ")),1),t("td",null,n(_(v)(l.fee_amount)),1),t("td",null,n(_(v)(P.value)),1)]))),128))]),s.editDeptList.length>0?(a(),o("tfoot",Dl,[t("tr",Al,[e[88]||(e[88]=t("td",{colspan:"3",align:"right"},"编辑部总计：",-1)),t("td",null,n(_(v)(P.value)),1)])])):d("",!0)]),e[96]||(e[96]=t("div",{class:"section-title mt-20"},[t("div",{class:"title-line"}),t("h3",null,"稿费代领后汇总")],-1)),t("table",Cl,[e[92]||(e[92]=t("thead",null,[t("tr",null,[t("th",null,"姓名"),t("th",null,"新闻部稿费"),t("th",null,"编辑部稿费"),t("th",null,"大图稿费"),t("th",null,"总金额")])],-1)),t("tbody",null,[s.summaryList.length===0?(a(),o("tr",$l,[...e[90]||(e[90]=[t("td",{colspan:"5",class:"empty-tip"},"暂无稿费汇总数据",-1)])])):d("",!0),(a(!0),o(g,null,k(s.summaryList,l=>(a(),o("tr",{key:l.user_name},[t("td",null,n(l.user_name),1),t("td",null,n(_(v)(l.news_fee)),1),t("td",null,n(_(v)(l.edit_fee)),1),t("td",null,n(_(v)(l.big_img_fee)),1),t("td",null,n(_(v)(l.total_fee)),1)]))),128))]),s.summaryList.length>0?(a(),o("tfoot",Ul,[t("tr",Il,[e[91]||(e[91]=t("td",{colspan:"1",align:"right"},"平台总计：",-1)),t("td",null,n(_(v)(s.totalNewsFee)),1),t("td",null,n(_(v)(s.totalEditFee)),1),t("td",null,n(_(v)(s.totalBigImgFee)),1),t("td",null,n(_(v)(s.totalAllFee)),1)])])):d("",!0)])])):d("",!0),lt.value?(a(),o("div",Sl,[t("div",Ll,[t("h4",null,n(z.value?"新增任务":"编辑任务"),1),t("div",Fl,[e[97]||(e[97]=t("label",null,"日期:",-1)),c(t("input",{type:"date",class:"form-input","onUpdate:modelValue":e[26]||(e[26]=l=>b.created_at=l)},null,512),[[I,b.created_at]])]),t("div",Vl,[e[98]||(e[98]=t("label",null,"任务名称:",-1)),c(t("input",{type:"text",class:"form-input","onUpdate:modelValue":e[27]||(e[27]=l=>b.article_title=l)},null,512),[[I,b.article_title]])]),t("div",xl,[e[99]||(e[99]=t("label",null,"参与人及金额:",-1)),c(t("input",{type:"text",class:"form-input","onUpdate:modelValue":e[28]||(e[28]=l=>b.userAmountDetail=l),placeholder:"如：张三(100),李四(200)"},null,512),[[I,b.userAmountDetail]])]),t("div",Ml,[e[101]||(e[101]=t("label",null,"部门:",-1)),c(t("select",{class:"form-input","onUpdate:modelValue":e[29]||(e[29]=l=>b.deptId=l)},[...e[100]||(e[100]=[t("option",{value:"news"},"新闻部",-1),t("option",{value:"edit"},"编辑部",-1)])],512),[[C,b.deptId]])]),t("div",El,[t("button",{class:"cancel-btn",onClick:e[30]||(e[30]=l=>lt.value=!1)},"取消"),t("button",{class:"confirm-btn",onClick:Dt},"确认")])])])):d("",!0)]),_:1}))}},Ol=jt(Nl,[["__scopeId","data-v-6a7285e5"]]);export{Ol as default};
