import{hi as Bt,r as p,hl as $,hI as z,f as Ot,hn as Zt,ho as a,hp as Kt,hq as t,hs as o,ht as m,hR as B,hr as c,hT as C,hu as k,hJ as w,hK as h,hv as n,b,hy as O,g3 as r,hW as wt,hQ as Qt,hZ as Jt}from"./index-CRrSqBSg.js";import{P as Wt}from"./PageBackground2-CY7PUuwQ.js";import{a as _}from"./Navbar-DqK1H5Mm.js";import{a as et,e as Gt,b as Ht}from"./royalty-DqTHozkf.js";import{c as Xt,g as te}from"./proxy-u4lCoTLr.js";import{a as ee,r as le,u as ht}from"./feedback-CsxdGIKI.js";import{F as se,a as ne}from"./feedbackStatus-DqnZOqTf.js";import{a as ae}from"./auth-C86FJw8D.js";const oe={class:"top-tabs"},re={key:0,class:"tab-content"},ue={class:"query-form"},ie={class:"content-table"},de={key:0},pe={key:1},me={class:"feedback-filter"},ce={class:"feedback-item-list"},ve={key:0,class:"empty-tip"},_e={class:"feedback-header"},be={class:"feedback-id"},fe={class:"feedback-content"},ye={class:"feedback-actions"},ge=["onClick"],ke=["onClick"],we={key:0,class:"pagination"},he=["disabled"],Ae=["disabled"],De={key:1,class:"dialog-mask"},$e={class:"dialog-content"},Ce={key:2,class:"dialog-mask"},Ue={class:"dialog-content"},Ie={key:2,class:"tab-content"},Se={class:"content-table"},Ve={key:0},Le={key:0,class:"role-tag super-admin"},Fe={key:1,class:"role-tag dept-admin"},xe={key:2,class:"role-tag normal-user"},Me={class:"op-btn-group"},Pe=["onClick"],Re=["onClick"],Ee={key:0,class:"dialog-mask"},Ne={class:"dialog-content"},Te={class:"form-row"},Ye={class:"form-row"},je={class:"form-row"},qe={key:0,class:"form-row"},ze={key:1,class:"form-row"},Be={class:"dialog-btns"},Oe={key:1,class:"dialog-mask"},Ze={class:"dialog-content"},Ke={class:"form-row"},Qe={class:"form-row"},Je={class:"form-row"},We={class:"dialog-btns"},Ge={key:3,class:"tab-content"},He={class:"form-row",style:{"align-items":"center",gap:"20px","margin-bottom":"20px","flex-wrap":"wrap"}},Xe={style:{display:"flex","align-items":"center",gap:"10px"}},tl=["value"],el=["value"],ll={class:"dept-section"},sl={class:"content-table"},nl={key:0},al={class:"total-row bold"},ol={class:"dept-section"},rl={class:"content-table"},ul={key:0},il={class:"total-row"},dl={class:"dept-section"},pl={class:"content-table"},ml={key:0},cl={class:"total-row"},vl={class:"total-row"},_l={class:"total-row bold"},bl={key:4,class:"tab-content"},fl={class:"form-row"},yl=["disabled"],gl={class:"content-table"},kl={key:0},wl={class:"content-table"},hl={key:0},Al={key:0},Dl={class:"total-row"},$l={class:"content-table"},Cl={key:0},Ul={key:0},Il={class:"total-row"},Sl={class:"content-table"},Vl={key:0},Ll={key:0},Fl={class:"total-row"},xl={key:5,class:"dialog-mask"},Ml={class:"dialog-content"},Pl={class:"form-row"},Rl={class:"form-row"},El={class:"form-row"},Nl={class:"form-row"},Tl={class:"dialog-btns"},Yl={__name:"SuperManage",setup(jl){const A=p("query"),P={1:"新闻部",2:"编辑部",3:"运营部",news:1,edit:2,operation:3},lt=async s=>{switch(A.value=s,s){case"query":await K();break;case"manage":await J(),await ft();break;case"user":await G();break;case"summary":break;case"account":await J();break;case"feedback":await Q();break}},U=$({month:"",deptId:"",article_title:""}),st=p([]),nt=p(!1),Z=p(!1),f=$({record_id:"",created_at:"",article_title:"",real_names:[],fee_amount:0,deptId:""}),K=async()=>{try{const s=new Date().getFullYear(),e={statistical_month:U.month?`${s}-${U.month.padStart(2,"0")}`:"",department_id:P[U.deptId]||"",article_title:U.article_title},l=await et(e);if(l.res_code==="0000"){const i=l.data?.list||[];st.value=i.map(d=>{const y=d.real_names?d.real_names.join(","):"未知人员",D=d.fee_amount||0;return{...d,userAmountDetail:`${y}(${D}元)`,deptName:P[d.department_id]||"未知部门"}})}else r.error(`获取任务列表失败：${l.res_msg}`)}catch{r.error("网络异常，获取任务列表失败")}},At=async()=>{if(!f.article_title||!f.deptId||f.fee_amount<=0){r.warning("请填写任务名称、选择部门并输入有效金额");return}try{const s={record_id:f.record_id,article_title:f.article_title,real_names:f.real_names,fee_amount:f.fee_amount,department_id:P[f.deptId]},e=await Ht(s);e.res_code==="0000"?(r.success(Z.value?"新增任务成功":"编辑任务成功"),nt.value=!1,await K()):r.error(`${Z.value?"新增":"编辑"}任务失败：${e.res_msg}`)}catch{r.error(`网络异常，${Z.value?"新增":"编辑"}任务失败`)}},L=p([]),Dt=p(0),S=p(1),at=p(2),F=p(""),x=p(""),ot=$({page:1,size:100,status:""}),rt=p(!1),V=p(""),M=$({reply_content:""}),ut=p(!1),R=$({status:"pending"}),it=z(()=>{let s=[...L.value];if(F.value&&(s=s.filter(i=>i.created_at?.split("-")[1]===F.value.padStart(2,"0"))),x.value){const i=x.value.trim().toLowerCase();s=s.filter(d=>d.real_name?.toLowerCase().includes(i))}const e=(S.value-1)*at.value,l=e+at.value;return s.slice(e,l)}),dt=z(()=>{let s=[...L.value];if(F.value&&(s=s.filter(e=>e.created_at?.split("-")[1]===F.value.padStart(2,"0"))),x.value){const e=x.value.trim().toLowerCase();s=s.filter(l=>l.real_name?.toLowerCase().includes(e))}return Math.ceil(s.length/at.value)||1}),Q=async()=>{try{const s=await ee(ot);s.res_code==="0000"?(L.value=s.data.list||[],Dt.value=s.data.total||0,S.value=1):(r.error(`查询失败：${s.res_msg}`),L.value=[])}catch{r.error("网络异常，查询反馈失败"),L.value=[]}},$t=()=>{S.value=1},vt=s=>{s<1||s>dt.value||(S.value=s)},Ct=s=>{V.value=s,M.reply_content="",rt.value=!0},_t=()=>{rt.value=!1,V.value="",M.reply_content=""},Ut=async()=>{if(!M.reply_content.trim()){r.warning("请输入回复内容");return}try{const s=await le(V.value,{reply_content:M.reply_content});s.res_code==="0000"?(r.success("回复成功"),_t(),await ht(V.value,{status:"replied"}),await Q()):r.error(`回复失败：${s.res_msg}`)}catch{r.error("网络异常，回复失败")}},It=s=>{V.value=s;const e=L.value.find(l=>l.feedback_id===s);e&&(R.status=e.status||"pending"),ut.value=!0},bt=()=>{ut.value=!1,V.value="",R.status="pending"},St=async()=>{try{const s=await ht(V.value,{status:R.status});s.res_code==="0000"?(r.success("状态更新成功"),bt(),await Q()):r.error(`状态更新失败：${s.res_msg}`)}catch{r.error("网络异常，状态更新失败")}};$({month:"",feeRecordId:"",proxyUserId:"",beProxyUserId:"",deptId:"",amount:0});const pt=p([]),I=p([]),Vt=p([]),J=async()=>{try{const s=await wt({page:1,size:999});s.res_code==="0000"?(I.value=s.data?.list||[],I.value.length>0):r.error(`加载成员列表失败：${s.res_msg}`)}catch{r.error("网络异常，加载成员列表失败")}},Lt=async()=>{try{const s=await et({page:1,size:100});s.res_code==="0000"?Vt.value=s.data?.list||[]:r.error(`加载稿费记录失败：${s.res_msg}`)}catch{r.error("网络异常，加载稿费记录失败")}},ft=async()=>{try{const s=await te();if(s.res_code==="0000"){const e=s.data?.list||[];pt.value=e.map(l=>{const i=I.value.find(D=>D.user_id==l.proxy_user_id)?.real_name||"未知用户",d=I.value.find(D=>D.user_id==l.original_user_id)?.real_name||"未知用户",y=P[l.department_id]||"未知部门";return{...l,proxyUser:i,beProxyUser:d,deptName:y}})}else r.error(`获取代领列表失败：${s.res_msg}`)}catch{r.error("网络异常，获取代领列表失败")}};p(!1),$({proxy_id:"",proxy_user_id:"",original_user_id:"",department_id:"",proxy_month:"",fee_record_id:"",article_title:"",fee_amount:0,description:""});const Ft=async()=>{await J(),await Lt(),await ft()};Ot(()=>{console.log("进入系统管理员页面，组件挂载，开始初始化数据"),Ft(),gt()});const E=p(!1),N=p(!1),u=$({userId:"",real_name:"",student_number:"",email:"",password:"",confirmPassword:"",created_at:"",deptId:""}),W=p(!1),v=$({user_id:"",real_name:"",is_super_admin:!1,department_id:"",role:"普通成员"}),G=async()=>{try{const s=await wt();s.res_code==="0000"?I.value=s.data.list||[]:r.error(`获取人员列表失败：${s.res_msg}`)}catch{r.error("网络异常，获取人员列表失败")}},xt=(s={})=>{N.value=!s.user_id,u.userId=s.user_id||"",u.real_name=s.real_name||"",u.student_number=s.student_number||"",u.email=s.email||"",u.created_at=s.created_at||"",u.deptId=s.department_id||"1",E.value=!0},Mt=async()=>{if(N.value){const s=u.real_name.trim(),e=/^[\u4e00-\u9fa5]{2,}$/;if(!s){r.warning("请输入真实姓名");return}if(!e.test(s)){r.warning("真实姓名需为不少于两个字的纯中文");return}const l=/^\d{12}$/;if(!u.student_number||!l.test(u.student_number)){r.warning("请输入12位纯数字的学号");return}const i=/^[a-zA-Z0-9._%-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/;if(!u.email||!i.test(u.email)){r.warning("请输入有效的邮箱地址");return}if(!u.password.trim()){r.warning("请设置密码");return}if(u.password!==u.confirmPassword){r.warning("两次输入的密码不一致");return}try{const d={sign:"admin_sign_123456",student_number:u.student_number,real_name:u.real_name,password:u.password,email:u.email},y=await ae(d);y.res_code==="0000"?(r.success("新增成员（注册）成功"),E.value=!1,await G(),Object.assign(u,{userId:"",real_name:"",student_number:"",email:"",password:"",confirmPassword:""})):r.error(`新增成员失败：${y.res_msg}`)}catch(d){r.error("网络异常，新增成员失败"),console.error("注册接口调用失败：",d)}return}if(!u.real_name||!u.created_at||!u.deptId){r.warning("请填写所有必填字段");return}try{const s=await Qt({user_id:u.userId,real_name:u.real_name,student_number:u.student_number,email:u.email,department_id:u.deptId,created_at:u.created_at});s.res_code==="0000"?(r.success("编辑成员成功"),E.value=!1,await G()):r.error(`编辑成员失败：${s.res_msg}`)}catch{r.error("网络异常，编辑成员失败")}},Pt=s=>{v.user_id=s.user_id,v.real_name=s.real_name,v.is_super_admin=s.is_super_admin||!1,v.department_id=s.department_id||"",v.role=s.role||"普通成员",W.value=!0},Rt=async()=>{if(!v.user_id||v.department_id===""){r.warning("请选择用户所属部门");return}try{const s={sign:"admin_sign_123456",user_id:v.user_id,is_super_admin:v.is_super_admin,department_id:v.department_id},e=await Jt(s);if(e.res_code==="0000"){r.success("角色权限修改成功"),W.value=!1;const l=I.value.findIndex(i=>i.user_id===v.user_id);if(l>-1){const i={...I.value[l],is_super_admin:v.is_super_admin,department_id:v.is_super_admin?"":v.department_id,role:v.is_super_admin?"系统管理员":v.role};I.value[l]=i}}else r.error(`角色修改失败：${e.res_msg}`)}catch(s){r.error("网络异常，角色修改失败"),console.error("修改用户角色报错：",s)}},Et=async s=>{try{const e=await Xt(s);e.res_code==="0000"?(r.success("移除成员成功"),await G()):r.error(`移除成员失败：${e.res_msg}`)}catch{r.error("网络异常，移除成员失败")}},H=p(""),T=p(""),yt=p([]),mt=$({statistical_month:"",department_id:"",format:""}),Nt=()=>{const s=new Date().getFullYear(),e=s,l=s+3,i=[];for(let d=e;d<=l;d++)i.push(d);return i},gt=()=>{T.value="",yt.value=Array.from({length:12},(s,e)=>{const l=e+1;return{value:String(l).padStart(2,"0"),label:`${l}月`}})},Tt=()=>{H.value&&T.value&&(mt.statistical_month=`${H.value}-${T.value}`,jt())},X=p([]),tt=p([]),ct=p([]),Y=z(()=>_(X.value.reduce((s,e)=>s+Number(e.fee_amount||0),0))),j=z(()=>_(tt.value.reduce((s,e)=>s+Number(e.totalAmount),0))),Yt=z(()=>_(Number(Y.value)+Number(j.value))),jt=async()=>{if(!mt.statistical_month){r.warning("请选择统计月份（YYYY-MM）");return}try{const[s,e]=mt.statistical_month.split("-"),l=`${s}-${e}-01`,i=new Date(Number(s),Number(e),0).toISOString().split("T")[0],d=await et({startDate:l,endDate:i,page:1,size:100,department_id:1});if(d.res_code==="0000"){const y=d.data.list||[];X.value=y.map(g=>({...g,real_names:Array.isArray(g.real_names)?g.real_names.join(", "):g.real_names||"-"}));const D=await et({startDate:l,endDate:i,page:1,size:100,department_id:2});D.res_code==="0000"&&(tt.value=D.data.list.map(g=>({...g,real_names:Array.isArray(g.real_names)?g.real_names.join(", "):g.real_names||"-"}))),qt([...y,...D.data?.list||[]])}else r.error(`获取汇总数据失败：${d.res_msg}`)}catch(s){console.error("获取汇总数据失败:",s),r.error("网络异常，获取汇总数据失败")}},qt=s=>{const e=new Map;s.forEach(l=>{const i=l.user_ids?.length||0;if(i!==0)for(let d=0;d<i;d++){const y=l.user_ids[d],D=l.real_names[d]||"未知";e.has(y)||e.set(y,{userId:y,real_name:D,newsAmount:0,editAmount:0,bigImgAmount:0,totalAmount:0});const g=e.get(y),kt=Number(l.fee_amount)/i;l.department_id===1&&(g.newsAmount+=kt),l.department_id===2&&(g.editAmount+=kt)}}),ct.value=Array.from(e.values()).map(l=>({...l,totalAmount:l.newsAmount+l.editAmount+l.bigImgAmount}))},q=$({month:""});p([]);const zt=async()=>{if(!q.month){r.warning("请选择月份");return}const e=`${new Date().getFullYear()}-${q.month}`;try{r.loading({message:"导出中...",duration:0});const l=await Gt({statistical_month:e,type:"proxy"});if(r.closeAll(),l.res_code==="0000"){const i=document.createElement("a");i.href=l.data.download_url,i.download=`代领调整后稿费_${e}.xlsx`,i.click(),r.success("导出成功")}else r.error(`导出失败：${l.res_msg}`)}catch(l){r.closeAll(),r.error("网络异常，导出失败"),console.error("做账数据导出失败：",l)}};return K(),J(),(s,e)=>(a(),Zt(Wt,null,{"card-content":Kt(()=>[t("div",oe,[t("button",{class:B(["top-tab-btn",{active:A.value==="query"}]),onClick:e[0]||(e[0]=l=>lt("query"))}," 任务查询 ",2),t("button",{class:B(["top-tab-btn",{active:A.value==="feedback"}]),onClick:e[1]||(e[1]=()=>{A.value="feedback",Q()})}," 查看反馈 ",2),t("button",{class:B(["top-tab-btn",{active:A.value==="user"}]),onClick:e[2]||(e[2]=l=>lt("user"))}," 人员管理 ",2),t("button",{class:B(["top-tab-btn",{active:A.value==="summary"}]),onClick:e[3]||(e[3]=l=>lt("summary"))}," 稿费汇总 ",2)]),A.value==="query"?(a(),o("div",re,[t("div",ue,[e[36]||(e[36]=t("label",null,"选择月份:",-1)),c(t("select",{class:"form-select","onUpdate:modelValue":e[4]||(e[4]=l=>U.month=l)},[...e[34]||(e[34]=[t("option",{value:""},"全部",-1),t("option",{value:"01"},"1月",-1),t("option",{value:"02"},"2月",-1),t("option",{value:"03"},"3月",-1),t("option",{value:"04"},"4月",-1),t("option",{value:"05"},"5月",-1),t("option",{value:"06"},"6月",-1),t("option",{value:"07"},"7月",-1),t("option",{value:"08"},"8月",-1),t("option",{value:"09"},"9月",-1),t("option",{value:"10"},"10月",-1),t("option",{value:"11"},"11月",-1),t("option",{value:"12"},"12月",-1)])],512),[[C,U.month]]),e[37]||(e[37]=t("label",null,"选择部门:",-1)),c(t("select",{class:"form-select","onUpdate:modelValue":e[5]||(e[5]=l=>U.deptId=l)},[...e[35]||(e[35]=[t("option",{value:""},"全部",-1),t("option",{value:"news"},"新闻部",-1),t("option",{value:"edit"},"编辑部",-1),t("option",{value:"operation"},"运营部",-1)])],512),[[C,U.deptId]]),e[38]||(e[38]=t("label",null,"任务名称:",-1)),c(t("input",{type:"text",placeholder:"输入任务名称查询",class:"form-input","onUpdate:modelValue":e[6]||(e[6]=l=>U.article_title=l)},null,512),[[k,U.article_title]]),t("button",{class:"query-btn",onClick:K},"查询")]),t("table",ie,[e[40]||(e[40]=t("thead",null,[t("tr",null,[t("th",null,"日期"),t("th",null,"任务名称"),t("th",null,"参与人"),t("th",null,"金额详情"),t("th",null,"部门")])],-1)),t("tbody",null,[st.value.length===0?(a(),o("tr",de,[...e[39]||(e[39]=[t("td",{colspan:"5",class:"empty-tip"},"暂无任务记录",-1)])])):m("",!0),(a(!0),o(w,null,h(st.value,l=>(a(),o("tr",{key:l.record_id},[t("td",null,n(l.created_at),1),t("td",null,n(l.article_title),1),t("td",null,n(l.real_names?.join(", ")||"-"),1),t("td",null,n(l.fee_amount),1),t("td",null,n(l.deptName),1)]))),128))])])])):m("",!0),A.value==="feedback"?(a(),o("div",pe,[t("div",me,[e[43]||(e[43]=t("label",null,"反馈状态:",-1)),c(t("select",{class:"form-select","onUpdate:modelValue":e[7]||(e[7]=l=>ot.status=l)},[...e[41]||(e[41]=[t("option",{value:""},"全部",-1),t("option",{value:"pending"},"待处理",-1),t("option",{value:"replied"},"已回复",-1)])],512),[[C,ot.status]]),e[44]||(e[44]=t("label",null,"月份:",-1)),c(t("select",{class:"form-select","onUpdate:modelValue":e[8]||(e[8]=l=>F.value=l)},[...e[42]||(e[42]=[t("option",{value:""},"全部",-1),t("option",{value:"1"},"1月",-1)])],512),[[C,F.value]]),e[45]||(e[45]=t("label",null,"用户姓名:",-1)),c(t("input",{type:"text",placeholder:"输入姓名模糊查询",class:"form-input","onUpdate:modelValue":e[9]||(e[9]=l=>x.value=l)},null,512),[[k,x.value]]),t("button",{class:"query-btn",onClick:$t},"查询")]),t("div",ce,[it.value.length===0?(a(),o("div",ve,"暂无反馈数据")):m("",!0),(a(!0),o(w,null,h(it.value,l=>(a(),o("div",{class:"feedback-item",key:l.feedback_id},[t("div",_e,[t("span",be,"反馈ID："+n(l.feedback_id),1),t("span",{class:B(["status-tag",b(se)[l.status]])},n(b(ne)[l.status]),3)]),t("div",fe,[t("p",null,[e[46]||(e[46]=t("span",{class:"label"},"反馈用户：",-1)),O(n(l.real_name),1)]),t("p",null,[e[47]||(e[47]=t("span",{class:"label"},"反馈内容：",-1)),O(n(l.content),1)]),t("p",null,[e[48]||(e[48]=t("span",{class:"label"},"反馈时间：",-1)),O(n(l.created_at),1)]),t("p",null,[e[49]||(e[49]=t("span",{class:"label"},"回复时间：",-1)),O(n(l.replied_at||"未回复"),1)]),t("p",null,[e[50]||(e[50]=t("span",{class:"label"},"回复内容：",-1)),O(n(l.reply_content||"暂无回复"),1)])]),t("div",ye,[t("button",{class:"op-btn reply-btn",onClick:i=>Ct(l.feedback_id)},"回复",8,ge),t("button",{class:"op-btn status-btn",onClick:i=>It(l.feedback_id)},"改状态",8,ke)])]))),128))]),it.value.length>0?(a(),o("div",we,[t("button",{class:"page-btn",onClick:e[10]||(e[10]=l=>vt(S.value-1)),disabled:S.value<=1}," 上一页 ",8,he),t("span",null,"第"+n(S.value)+"页 / 共"+n(dt.value)+"页",1),t("button",{class:"page-btn",onClick:e[11]||(e[11]=l=>vt(S.value+1)),disabled:S.value>=dt.value}," 下一页 ",8,Ae)])):m("",!0),rt.value?(a(),o("div",De,[t("div",$e,[t("h4",null,"回复反馈（ID: "+n(V.value)+"）",1),c(t("textarea",{placeholder:"请输入回复内容",class:"reply-textarea","onUpdate:modelValue":e[12]||(e[12]=l=>M.reply_content=l)},null,512),[[k,M.reply_content]]),t("div",{class:"dialog-btns"},[t("button",{class:"cancel-btn",onClick:_t},"取消"),t("button",{class:"confirm-btn",onClick:Ut},"提交回复")])])])):m("",!0),ut.value?(a(),o("div",Ce,[t("div",Ue,[t("h4",null,"更新反馈状态（ID: "+n(V.value)+"）",1),c(t("select",{class:"form-select","onUpdate:modelValue":e[13]||(e[13]=l=>R.status=l)},[...e[51]||(e[51]=[t("option",{value:"pending"},"待处理",-1),t("option",{value:"replied"},"已回复",-1)])],512),[[C,R.status]]),t("div",{class:"dialog-btns"},[t("button",{class:"cancel-btn",onClick:bt},"取消"),t("button",{class:"confirm-btn",onClick:St},"确认更新")])])])):m("",!0)])):m("",!0),A.value==="user"?(a(),o("div",Ie,[e[65]||(e[65]=t("div",{class:"section-title"},[t("div",{class:"title-line"}),t("h3",null,"目前成员")],-1)),t("button",{class:"add-btn",onClick:e[14]||(e[14]=l=>xt())},"新增成员"),t("table",Se,[e[53]||(e[53]=t("thead",null,[t("tr",null,[t("th",null,"真实姓名"),t("th",null,"学号"),t("th",null,"邮箱"),t("th",null,"所属部门"),t("th",null,"角色权限"),t("th",null,"操作")])],-1)),t("tbody",null,[I.value.length===0?(a(),o("tr",Ve,[...e[52]||(e[52]=[t("td",{colspan:"8",class:"empty-tip"},"暂无成员记录",-1)])])):m("",!0),(a(!0),o(w,null,h(I.value,l=>(a(),o("tr",{key:l.user_id},[t("td",null,n(l.real_name),1),t("td",null,n(l.student_number||"-"),1),t("td",null,n(l.email||"-"),1),t("td",null,n(P[l.department_id]||"无"),1),t("td",null,[l.is_super_admin?(a(),o("span",Le,"系统管理员")):l.department_id&&l.department_id!==""?(a(),o("span",Fe,"部门管理员")):(a(),o("span",xe,"普通用户"))]),t("td",null,[t("div",Me,[t("button",{class:"op-btn primary",onClick:i=>Pt(l)},"修改角色",8,Pe),t("button",{class:"op-btn danger",onClick:i=>Et(l.user_id)},"移除",8,Re)])])]))),128))])]),E.value?(a(),o("div",Ee,[t("div",Ne,[t("h4",null,n(N.value?"新增成员":"编辑成员"),1),t("div",Te,[e[54]||(e[54]=t("label",{class:"justify-label"},"成员姓名:",-1)),c(t("input",{type:"text",class:"form-input","onUpdate:modelValue":e[15]||(e[15]=l=>u.real_name=l),placeholder:"请输入真实姓名"},null,512),[[k,u.real_name]])]),t("div",Ye,[e[55]||(e[55]=t("label",{class:"justify-label"},"学号:",-1)),c(t("input",{type:"text",class:"form-input","onUpdate:modelValue":e[16]||(e[16]=l=>u.student_number=l),placeholder:"请输入12位纯数字学号",maxlength:"12"},null,512),[[k,u.student_number]])]),t("div",je,[e[56]||(e[56]=t("label",{class:"justify-label"},"邮箱:",-1)),c(t("input",{type:"email",class:"form-input","onUpdate:modelValue":e[17]||(e[17]=l=>u.email=l),placeholder:"请输入有效邮箱"},null,512),[[k,u.email]])]),N.value?(a(),o("div",qe,[e[57]||(e[57]=t("label",{class:"justify-label"},"密码:",-1)),c(t("input",{type:"password",class:"form-input","onUpdate:modelValue":e[18]||(e[18]=l=>u.password=l),placeholder:"请设置密码"},null,512),[[k,u.password]])])):m("",!0),N.value?(a(),o("div",ze,[e[58]||(e[58]=t("label",{class:"justify-label"},"确认密码:",-1)),c(t("input",{type:"password",class:"form-input","onUpdate:modelValue":e[19]||(e[19]=l=>u.confirmPassword=l),placeholder:"请再次输入密码"},null,512),[[k,u.confirmPassword]])])):m("",!0),t("div",Be,[t("button",{class:"cancel-btn",onClick:e[20]||(e[20]=l=>E.value=!1)},"取消"),t("button",{class:"confirm-btn",onClick:Mt},"确认")])])])):m("",!0),W.value?(a(),o("div",Oe,[t("div",Ze,[e[64]||(e[64]=t("h4",null,"修改用户角色权限",-1)),t("div",Ke,[e[59]||(e[59]=t("label",null,"用户姓名:",-1)),c(t("input",{type:"text",class:"form-input","onUpdate:modelValue":e[21]||(e[21]=l=>v.real_name=l),disabled:""},null,512),[[k,v.real_name]])]),t("div",Qe,[e[61]||(e[61]=t("label",null,"所属部门:",-1)),c(t("select",{class:"form-input","onUpdate:modelValue":e[22]||(e[22]=l=>v.department_id=l)},[...e[60]||(e[60]=[t("option",{value:""},"请选择部门",-1),t("option",{value:"1"},"新闻部",-1),t("option",{value:"2"},"编辑部",-1),t("option",{value:"3"},"运营部",-1)])],512),[[C,v.department_id]])]),t("div",Je,[e[63]||(e[63]=t("label",null,"用户角色:",-1)),c(t("select",{class:"form-input","onUpdate:modelValue":e[23]||(e[23]=l=>v.role=l)},[...e[62]||(e[62]=[t("option",{value:"部门管理员"},"部门管理员",-1),t("option",{value:"系统管理员"},"系统管理员",-1)])],512),[[C,v.role]])]),t("div",We,[t("button",{class:"cancel-btn",onClick:e[24]||(e[24]=l=>W.value=!1)},"取消"),t("button",{class:"confirm-btn",onClick:Rt},"确认修改")])])])):m("",!0)])):m("",!0),A.value==="summary"?(a(),o("div",Ge,[e[84]||(e[84]=t("div",{class:"section-title"},[t("div",{class:"title-line"}),t("h3",null,"稿费汇总与导出")],-1)),t("div",He,[t("div",Xe,[e[68]||(e[68]=t("label",null,"统计月份:",-1)),c(t("select",{class:"form-select","onUpdate:modelValue":e[25]||(e[25]=l=>H.value=l),onChange:gt},[e[66]||(e[66]=t("option",{value:""},"请选择年份",-1)),(a(!0),o(w,null,h(Nt(),l=>(a(),o("option",{key:l,value:l},n(l)+"年 ",9,tl))),128))],544),[[C,H.value]]),c(t("select",{class:"form-select","onUpdate:modelValue":e[26]||(e[26]=l=>T.value=l),onChange:Tt},[e[67]||(e[67]=t("option",{value:""},"请选择月份",-1)),(a(!0),o(w,null,h(yt.value,l=>(a(),o("option",{key:l.value,value:l.value},n(l.label),9,el))),128))],544),[[C,T.value]])]),e[69]||(e[69]=t("div",{style:{display:"flex","align-items":"center"}},null,-1))]),t("div",ll,[e[73]||(e[73]=t("label",null,"新闻部:",-1)),t("table",sl,[e[71]||(e[71]=t("thead",null,[t("tr",null,[t("th",null,"日期"),t("th",null,"任务名称"),t("th",null,"拍摄人员"),t("th",null,"任务总金额")])],-1)),t("tbody",null,[X.value.length===0?(a(),o("tr",nl,[...e[70]||(e[70]=[t("td",{colspan:"4",class:"empty-tip"},"暂无新闻部稿费记录",-1)])])):m("",!0),(a(!0),o(w,null,h(X.value,l=>(a(),o("tr",{key:l.record_id},[t("td",null,n(l.created_at||"-"),1),t("td",null,n(l.article_title||"-"),1),t("td",null,n(l.real_names||"-"),1),t("td",null,n(b(_)(l.fee_amount))+"元",1)]))),128))])]),t("div",al,[e[72]||(e[72]=t("label",null,"新闻部总稿费:",-1)),t("span",null,n(Y.value)+"元",1)])]),t("div",ol,[e[77]||(e[77]=t("label",null,"编辑部:",-1)),t("table",rl,[e[75]||(e[75]=t("thead",null,[t("tr",null,[t("th",null,"日期"),t("th",null,"任务名称"),t("th",null,"拍摄人员"),t("th",null,"任务总金额")])],-1)),t("tbody",null,[tt.value.length===0?(a(),o("tr",ul,[...e[74]||(e[74]=[t("td",{colspan:"4",class:"empty-tip"},"暂无编辑部稿费记录",-1)])])):m("",!0),(a(!0),o(w,null,h(tt.value,l=>(a(),o("tr",{key:l.projectId},[t("td",null,n(l.created_at)+"元",1),t("td",null,n(l.article_title),1),t("td",null,n(l.real_names),1),t("td",null,n(l.fee_amount)+"元",1)]))),128))])]),t("div",il,[e[76]||(e[76]=t("label",null,"编辑部总:",-1)),t("span",null,n(j.value)+"元",1)])]),t("div",dl,[e[83]||(e[83]=t("label",null,"稿费汇总:",-1)),t("table",pl,[e[79]||(e[79]=t("thead",null,[t("tr",null,[t("th",null,"姓名"),t("th",null,"新闻部稿费"),t("th",null,"编辑部稿费"),t("th",null,"大图稿费"),t("th",null,"总金额")])],-1)),t("tbody",null,[ct.value.length===0?(a(),o("tr",ml,[...e[78]||(e[78]=[t("td",{colspan:"5",class:"empty-tip"},"暂无汇总数据",-1)])])):m("",!0),(a(!0),o(w,null,h(ct.value,l=>(a(),o("tr",{key:l.userId},[t("td",null,n(l.real_name),1),t("td",null,n(l.newsAmount)+"元",1),t("td",null,n(l.editAmount)+"元",1),t("td",null,n(l.bigImgAmount)+"元",1),t("td",null,n(l.totalAmount)+"元",1)]))),128))])]),t("div",cl,[e[80]||(e[80]=t("label",null,"新闻部总:",-1)),t("span",null,n(Y.value)+"元",1)]),t("div",vl,[e[81]||(e[81]=t("label",null,"编辑部总:",-1)),t("span",null,n(j.value)+"元",1)]),t("div",_l,[e[82]||(e[82]=t("label",null,"平台总稿费:",-1)),t("span",null,n(Yt.value)+"元",1)])])])):m("",!0),A.value==="account"?(a(),o("div",bl,[e[98]||(e[98]=t("div",{class:"section-title"},[t("div",{class:"title-line"}),t("h3",null,"代领调整后稿费")],-1)),t("div",fl,[e[86]||(e[86]=t("label",null,"选择月份:",-1)),c(t("select",{class:"form-select","onUpdate:modelValue":e[27]||(e[27]=l=>q.month=l),onChange:e[28]||(e[28]=(...l)=>s.fetchAllAccountData&&s.fetchAllAccountData(...l))},[...e[85]||(e[85]=[t("option",{value:""},"请选择",-1),t("option",{value:"01"},"1月",-1),t("option",{value:"02"},"2月",-1),t("option",{value:"03"},"3月",-1),t("option",{value:"04"},"4月",-1),t("option",{value:"05"},"5月",-1),t("option",{value:"06"},"6月",-1),t("option",{value:"07"},"7月",-1),t("option",{value:"08"},"8月",-1),t("option",{value:"09"},"9月",-1),t("option",{value:"10"},"10月",-1),t("option",{value:"11"},"11月",-1),t("option",{value:"12"},"12月",-1)])],544),[[C,q.month]]),t("button",{class:"export-btn",onClick:zt,disabled:!q.month}," 导出本月做账数据 ",8,yl)]),t("table",gl,[e[88]||(e[88]=t("thead",null,[t("tr",null,[t("th",null,"代领人"),t("th",null,"被代领人"),t("th",null,"代领部门"),t("th",null,"代领金额"),t("th",null,"最终金额")])],-1)),t("tbody",null,[pt.value.length===0?(a(),o("tr",kl,[...e[87]||(e[87]=[t("td",{colspan:"5",class:"empty-tip"},"暂无代领记录数据",-1)])])):m("",!0),(a(!0),o(w,null,h(pt.value,l=>(a(),o("tr",{key:l.proxy_id},[t("td",null,n(l.proxy_user_name),1),t("td",null,n(l.original_user_name),1),t("td",null,n(l.department_name),1),t("td",null,n(b(_)(l.fee_amount)),1),t("td",null,n(b(_)(l.final_fee_amount)),1)]))),128))])]),e[99]||(e[99]=t("div",{class:"section-title mt-20"},[t("div",{class:"title-line"}),t("h3",null,"新闻部代领后")],-1)),t("table",wl,[e[91]||(e[91]=t("thead",null,[t("tr",null,[t("th",null,"日期"),t("th",null,"任务名称"),t("th",null,"拍摄人员"),t("th",null,"任务金额"),t("th",null,"总金额")])],-1)),t("tbody",null,[s.newsDeptList.length===0?(a(),o("tr",hl,[...e[89]||(e[89]=[t("td",{colspan:"5",class:"empty-tip"},"暂无新闻部代领后数据",-1)])])):m("",!0),(a(!0),o(w,null,h(s.newsDeptList,l=>(a(),o("tr",{key:l.record_id},[t("td",null,n(s.formatDate(l.created_at)),1),t("td",null,n(l.article_title),1),t("td",null,n(l.real_names.join(", ")),1),t("td",null,n(b(_)(l.fee_amount)),1),t("td",null,n(b(_)(Y.value)),1)]))),128))]),s.newsDeptList.length>0?(a(),o("tfoot",Al,[t("tr",Dl,[e[90]||(e[90]=t("td",{colspan:"4",align:"right"},"新闻部总计：",-1)),t("td",null,n(b(_)(Y.value)),1)])])):m("",!0)]),e[100]||(e[100]=t("div",{class:"section-title mt-20"},[t("div",{class:"title-line"}),t("h3",null,"编辑部代领后")],-1)),t("table",$l,[e[94]||(e[94]=t("thead",null,[t("tr",null,[t("th",null,"项目"),t("th",null,"供图人"),t("th",null,"金额详情"),t("th",null,"总金额")])],-1)),t("tbody",null,[s.editDeptList.length===0?(a(),o("tr",Cl,[...e[92]||(e[92]=[t("td",{colspan:"4",class:"empty-tip"},"暂无编辑部代领后数据",-1)])])):m("",!0),(a(!0),o(w,null,h(s.editDeptList,l=>(a(),o("tr",{key:l.record_id},[t("td",null,n(l.article_title),1),t("td",null,n(l.real_names.join(", ")),1),t("td",null,n(b(_)(l.fee_amount)),1),t("td",null,n(b(_)(j.value)),1)]))),128))]),s.editDeptList.length>0?(a(),o("tfoot",Ul,[t("tr",Il,[e[93]||(e[93]=t("td",{colspan:"3",align:"right"},"编辑部总计：",-1)),t("td",null,n(b(_)(j.value)),1)])])):m("",!0)]),e[101]||(e[101]=t("div",{class:"section-title mt-20"},[t("div",{class:"title-line"}),t("h3",null,"稿费代领后汇总")],-1)),t("table",Sl,[e[97]||(e[97]=t("thead",null,[t("tr",null,[t("th",null,"姓名"),t("th",null,"新闻部稿费"),t("th",null,"编辑部稿费"),t("th",null,"大图稿费"),t("th",null,"总金额")])],-1)),t("tbody",null,[s.summaryList.length===0?(a(),o("tr",Vl,[...e[95]||(e[95]=[t("td",{colspan:"5",class:"empty-tip"},"暂无稿费汇总数据",-1)])])):m("",!0),(a(!0),o(w,null,h(s.summaryList,l=>(a(),o("tr",{key:l.user_name},[t("td",null,n(l.user_name),1),t("td",null,n(b(_)(l.news_fee)),1),t("td",null,n(b(_)(l.edit_fee)),1),t("td",null,n(b(_)(l.big_img_fee)),1),t("td",null,n(b(_)(l.total_fee)),1)]))),128))]),s.summaryList.length>0?(a(),o("tfoot",Ll,[t("tr",Fl,[e[96]||(e[96]=t("td",{colspan:"1",align:"right"},"平台总计：",-1)),t("td",null,n(b(_)(s.totalNewsFee)),1),t("td",null,n(b(_)(s.totalEditFee)),1),t("td",null,n(b(_)(s.totalBigImgFee)),1),t("td",null,n(b(_)(s.totalAllFee)),1)])])):m("",!0)])])):m("",!0),nt.value?(a(),o("div",xl,[t("div",Ml,[t("h4",null,n(Z.value?"新增任务":"编辑任务"),1),t("div",Pl,[e[102]||(e[102]=t("label",null,"日期:",-1)),c(t("input",{type:"date",class:"form-input","onUpdate:modelValue":e[29]||(e[29]=l=>f.created_at=l)},null,512),[[k,f.created_at]])]),t("div",Rl,[e[103]||(e[103]=t("label",null,"任务名称:",-1)),c(t("input",{type:"text",class:"form-input","onUpdate:modelValue":e[30]||(e[30]=l=>f.article_title=l)},null,512),[[k,f.article_title]])]),t("div",El,[e[104]||(e[104]=t("label",null,"参与人及金额:",-1)),c(t("input",{type:"text",class:"form-input","onUpdate:modelValue":e[31]||(e[31]=l=>f.userAmountDetail=l),placeholder:"如：张三(100),李四(200)"},null,512),[[k,f.userAmountDetail]])]),t("div",Nl,[e[106]||(e[106]=t("label",null,"部门:",-1)),c(t("select",{class:"form-input","onUpdate:modelValue":e[32]||(e[32]=l=>f.deptId=l)},[...e[105]||(e[105]=[t("option",{value:"news"},"新闻部",-1),t("option",{value:"edit"},"编辑部",-1)])],512),[[C,f.deptId]])]),t("div",Tl,[t("button",{class:"cancel-btn",onClick:e[33]||(e[33]=l=>nt.value=!1)},"取消"),t("button",{class:"confirm-btn",onClick:At},"确认")])])])):m("",!0)]),_:1}))}},Wl=Bt(Yl,[["__scopeId","data-v-b38023c5"]]);export{Wl as default};
