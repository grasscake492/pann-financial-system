import{hh as E,hi as N,r as w,hk as v,hl as O,hm as U,hn as i,ho as b,hp as a,hq as c,hr as u,hs as m,ht as p,hu as l,hw as A,hx as C,hD as j,g2 as f}from"./index-C7oC9Sm-.js";import{P as z}from"./PageBackground-YvUIJ2ow.js";import{a as D}from"./auth-C9jdv531.js";import{a as I}from"./md5-BeoFLYFJ.js";const S={class:"register-container"},T={class:"form-group"},Z=["disabled"],$={key:0,class:"error-tip"},F={class:"form-group"},M=["disabled"],G={key:0,class:"error-tip"},H={class:"form-group"},J=["disabled"],K={key:0,class:"error-tip"},L={class:"form-group"},Q=["disabled"],W={key:0,class:"error-tip"},X={class:"form-group"},Y=["disabled"],ee={key:0,class:"error-tip"},se={class:"login-link"},te=["disabled"],oe={__name:"Register",setup(ae){const P=N(),h=w(null),e=v({username:"",account:"",email:"",password:"",confirmPwd:""}),s=v({username:"",account:"",email:"",password:"",confirmPwd:""}),n=w(!1),y=()=>{s.username="",e.username.trim()?/^[\u4e00-\u9fa5]+$/.test(e.username.trim())?s.username="":s.username="姓名仅支持输入中文":s.username="真实姓名不能为空"},k=()=>{s.account="";const t=e.account.trim();if(!t){s.account="学号不能为空";return}if(t.length!==12){s.account="学号必须为12位";return}/^\d{12}$/.test(t)?s.account="":s.account="学号必须为12位纯数字"},x=()=>{const t=/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/;e.email.trim()?t.test(e.email.trim())?s.email="":s.email="请输入有效的邮箱地址（如：xxx@qq.com）":s.email="邮箱不能为空"},R=()=>{e.password.trim()?e.password.length<8||e.password.length>16?s.password="密码需8-16位":s.password="":s.password="密码不能为空"},B=()=>{e.confirmPwd.trim()?e.confirmPwd!==e.password?s.confirmPwd="两次密码输入不一致":s.confirmPwd="":s.confirmPwd="请确认密码"},V=()=>{const t=I(e);return Object.assign(s,t),Object.keys(t).length===0},q=async()=>{if(V()){n.value=!0;try{const t={student_number:e.account,real_name:e.username,email:e.email,password:e.password},o=j(t),_={...t,sign:o},d=await D(_);switch(console.log("【注册接口返回结果】",d),d.res_code){case"0000":f.success(d.res_msg||"注册成功！即将跳转到登录页"),Object.keys(e).forEach(g=>e[g]=""),Object.keys(s).forEach(g=>s[g]=""),setTimeout(()=>P.push("/login"),1500);break;case"0005":f.error(d.res_msg||"该邮箱已被注册，请更换邮箱"),e.password="",e.confirmPwd="",s.confirmPwd="",h.value?.focus();break;default:f.error(d.res_msg||"注册失败，请联系管理员"),e.password="",e.confirmPwd=""}}catch(t){console.error("【注册请求失败 - 完整错误信息】",{message:t.message,response:t.response?{status:t.response.status,data:t.response.data}:"无响应数据",request:t.request?"请求已发送但无响应":"请求未发送"}),e.password="",e.confirmPwd="",f.error(t.response?.data?.res_msg||"网络异常，注册失败！")}finally{n.value=!1}}};return(t,o)=>{const _=O("router-link");return i(),U(z,null,{default:b(()=>[a("div",S,[o[6]||(o[6]=a("h1",{class:"system-title"},"PANN财务管理系统",-1)),a("div",T,[c(a("input",{type:"text",placeholder:"请输入真实姓名",class:"input-field","onUpdate:modelValue":o[0]||(o[0]=r=>e.username=r),onBlur:y,disabled:n.value},null,40,Z),[[p,e.username]]),s.username?(i(),u("div",$,l(s.username),1)):m("",!0)]),a("div",F,[c(a("input",{type:"text",placeholder:"请输入学号",class:"input-field","onUpdate:modelValue":o[1]||(o[1]=r=>e.account=r),onBlur:k,disabled:n.value},null,40,M),[[p,e.account]]),s.account?(i(),u("div",G,l(s.account),1)):m("",!0)]),a("div",H,[c(a("input",{type:"text",placeholder:"请输入邮箱",ref_key:"emailInput",ref:h,class:"input-field","onUpdate:modelValue":o[2]||(o[2]=r=>e.email=r),onBlur:x,disabled:n.value},null,40,J),[[p,e.email]]),s.email?(i(),u("div",K,l(s.email),1)):m("",!0)]),a("div",L,[c(a("input",{type:"password",placeholder:"请输入密码",class:"input-field","onUpdate:modelValue":o[3]||(o[3]=r=>e.password=r),onBlur:R,disabled:n.value},null,40,Q),[[p,e.password]]),s.password?(i(),u("div",W,l(s.password),1)):m("",!0)]),a("div",X,[c(a("input",{type:"password",placeholder:"请确认密码",class:"input-field","onUpdate:modelValue":o[4]||(o[4]=r=>e.confirmPwd=r),onBlur:B,disabled:n.value},null,40,Y),[[p,e.confirmPwd]]),s.confirmPwd?(i(),u("div",ee,l(s.confirmPwd),1)):m("",!0)]),a("div",se,[A(_,{to:"/login"},{default:b(()=>[...o[5]||(o[5]=[C("已有账号，登录",-1)])]),_:1})]),a("button",{class:"register-btn",onClick:q,disabled:n.value},l(n.value?"注册中...":"注册"),9,te)])]),_:1})}}},de=E(oe,[["__scopeId","data-v-c6be2d7b"]]);export{de as default};
