import{hi as oe,r as c,hl as F,hI as et,f as se,hm as M,hn as kt,ho as s,hp as I,hq as t,hs as r,ht as f,hS as N,hr as _,hU as U,hu as L,hJ as g,hK as k,hv as o,b as w,hy as E,hx as D,g3 as a,hW as It,g4 as ae,hQ as re}from"./index-DmjI61J4.js";import{P as ue}from"./PageBackground2-DIHdH8cQ.js";import{a as b,b as ie}from"./Navbar-h4UJXtjf.js";import{a as Vt,e as ht,b as de,c as pe}from"./royalty-Nces9iCc.js";import{a as me,u as ve,c as Ft,g as ce}from"./proxy-D0h2MFLt.js";import{a as _e,r as fe,u as Pt}from"./feedback-CqbHsbEQ.js";import{F as be,a as ye}from"./feedbackStatus-DqnZOqTf.js";const ge={class:"top-tabs"},ke={key:0,class:"tab-content"},we={class:"query-form"},xe={class:"content-table"},Ue={key:0},De={key:1},Ae={class:"feedback-filter"},$e={class:"feedback-item-list"},Ce={key:0,class:"empty-tip"},Ie={class:"feedback-header"},Ve={class:"feedback-id"},he={class:"feedback-content"},Fe={class:"feedback-actions"},Pe=["onClick"],Se=["onClick"],Le={key:0,class:"pagination"},Me=["disabled"],Ee=["disabled"],Ne={key:1,class:"dialog-mask"},Te={class:"dialog-content"},Re={key:2,class:"dialog-mask"},Ye={class:"dialog-content"},Be={key:2,class:"tab-content"},qe={class:"manage-form"},je={class:"form-row"},ze={class:"form-row"},Oe=["value"],Ke={class:"form-row"},Qe=["value"],He={class:"form-row"},Je=["value"],We={class:"form-row"},Ge={class:"form-row"},Xe={class:"content-table"},Ze={key:0},tl=["onClick"],el=["onClick"],ll={class:"dialog-footer"},nl={key:3,class:"tab-content"},ol={class:"content-table"},sl={key:0},al=["onClick"],rl=["onClick"],ul={key:0,class:"dialog-mask"},il={class:"dialog-content"},dl={class:"form-row"},pl={class:"form-row"},ml={class:"form-row"},vl={class:"dialog-btns"},cl={key:4,class:"tab-content"},_l={class:"form-row",style:{"align-items":"center",gap:"20px","margin-bottom":"20px","flex-wrap":"wrap"}},fl={style:{display:"flex","align-items":"center",gap:"10px"}},bl=["value"],yl=["value"],gl={style:{display:"flex","align-items":"center"}},kl={style:{display:"flex","align-items":"center"}},wl={class:"dept-section"},xl={class:"content-table"},Ul={key:0},Dl={class:"total-row bold"},Al={class:"dept-section"},$l={class:"content-table"},Cl={key:0},Il={class:"total-row"},Vl={class:"dept-section"},hl={class:"content-table"},Fl={key:0},Pl={class:"total-row"},Sl={class:"total-row"},Ll={class:"total-row bold"},Ml={key:5,class:"tab-content"},El={class:"form-row"},Nl=["disabled"],Tl={class:"content-table"},Rl={key:0},Yl={class:"content-table"},Bl={key:0},ql={key:0},jl={class:"total-row"},zl={class:"content-table"},Ol={key:0},Kl={key:0},Ql={class:"total-row"},Hl={class:"content-table"},Jl={key:0},Wl={key:0},Gl={class:"total-row"},Xl={key:6,class:"dialog-mask"},Zl={class:"dialog-content"},tn={class:"form-row"},en={class:"form-row"},ln={class:"form-row"},nn={class:"form-row"},on={class:"dialog-btns"},sn={__name:"ManageCenter",setup(an){const $=c("query"),q={1:"新闻部",2:"编辑部",3:"运营部",news:1,edit:2,operation:3},j=async n=>{switch($.value=n,n){case"query":await nt();break;case"manage":await st(),await K();break;case"user":await gt();break;case"summary":break;case"account":await st();break;case"feedback":await ot();break}},h=F({month:"",deptId:"",article_title:""}),pt=c([]),mt=c(!1),lt=c(!1),A=F({record_id:"",created_at:"",article_title:"",real_names:[],fee_amount:0,deptId:""}),nt=async()=>{try{const n=new Date().getFullYear(),e={statistical_month:h.month?`${n}-${h.month.padStart(2,"0")}`:"",department_id:q[h.deptId]||"",article_title:h.article_title},u=await Vt(e);if(u.res_code==="0000"){const v=u.data?.list||[];pt.value=v.map(d=>{const y=d.real_names?d.real_names.join(","):"未知人员",m=d.fee_amount||0;return{...d,userAmountDetail:`${y}(${m}元)`,deptName:q[d.department_id]||"未知部门"}})}else a.error(`获取任务列表失败：${u.res_msg}`)}catch{a.error("网络异常，获取任务列表失败")}},St=async()=>{if(!A.article_title||!A.deptId||A.fee_amount<=0){a.warning("请填写任务名称、选择部门并输入有效金额");return}try{const n={record_id:A.record_id,article_title:A.article_title,real_names:A.real_names,fee_amount:A.fee_amount,department_id:q[A.deptId]},e=await de(n);e.res_code==="0000"?(a.success(lt.value?"新增任务成功":"编辑任务成功"),mt.value=!1,await nt()):a.error(`${lt.value?"新增":"编辑"}任务失败：${e.res_msg}`)}catch{a.error(`网络异常，${lt.value?"新增":"编辑"}任务失败`)}},T=c([]),Lt=c(0),P=c(1),vt=c(2),R=c(""),Y=c(""),ct=F({page:1,size:100,status:""}),_t=c(!1),S=c(""),B=F({reply_content:""}),ft=c(!1),z=F({status:"pending"}),bt=et(()=>{let n=[...T.value];if(R.value&&(n=n.filter(v=>v.created_at?.split("-")[1]===R.value.padStart(2,"0"))),Y.value){const v=Y.value.trim().toLowerCase();n=n.filter(d=>d.real_name?.toLowerCase().includes(v))}const e=(P.value-1)*vt.value,u=e+vt.value;return n.slice(e,u)}),yt=et(()=>{let n=[...T.value];if(R.value&&(n=n.filter(e=>e.created_at?.split("-")[1]===R.value.padStart(2,"0"))),Y.value){const e=Y.value.trim().toLowerCase();n=n.filter(u=>u.real_name?.toLowerCase().includes(e))}return Math.ceil(n.length/vt.value)||1}),ot=async()=>{try{const n=await _e(ct);n.res_code==="0000"?(T.value=n.data.list||[],Lt.value=n.data.total||0,P.value=1):(a.error(`查询失败：${n.res_msg}`),T.value=[])}catch{a.error("网络异常，查询反馈失败"),T.value=[]}},Mt=()=>{P.value=1},wt=n=>{n<1||n>yt.value||(P.value=n)},Et=n=>{S.value=n,B.reply_content="",_t.value=!0},xt=()=>{_t.value=!1,S.value="",B.reply_content=""},Nt=async()=>{if(!B.reply_content.trim()){a.warning("请输入回复内容");return}try{const n=await fe(S.value,{reply_content:B.reply_content});n.res_code==="0000"?(a.success("回复成功"),xt(),await Pt(S.value,{status:"replied"}),await ot()):a.error(`回复失败：${n.res_msg}`)}catch{a.error("网络异常，回复失败")}},Tt=n=>{S.value=n;const e=T.value.find(u=>u.feedback_id===n);e&&(z.status=e.status||"pending"),ft.value=!0},Ut=()=>{ft.value=!1,S.value="",z.status="pending"},Rt=async()=>{try{const n=await Pt(S.value,{status:z.status});n.res_code==="0000"?(a.success("状态更新成功"),Ut(),await ot()):a.error(`状态更新失败：${n.res_msg}`)}catch{a.error("网络异常，状态更新失败")}},p=F({month:"",feeRecordId:"",proxyUserId:"",beProxyUserId:"",deptId:"",amount:0}),O=c([]),V=c([]),Dt=c([]),st=async()=>{try{const n=await It({page:1,size:999});n.res_code==="0000"?(V.value=n.data?.list||[],V.value.length>0):a.error(`加载成员列表失败：${n.res_msg}`)}catch{a.error("网络异常，加载成员列表失败")}},Yt=async()=>{try{const n=await Vt({page:1,size:100});n.res_code==="0000"?Dt.value=n.data?.list||[]:a.error(`加载稿费记录失败：${n.res_msg}`)}catch{a.error("网络异常，加载稿费记录失败")}},K=async()=>{try{const n=await ce();if(n.res_code==="0000"){const e=n.data?.list||[];O.value=e.map(u=>{const v=V.value.find(m=>m.user_id==u.proxy_user_id)?.real_name||"未知用户",d=V.value.find(m=>m.user_id==u.original_user_id)?.real_name||"未知用户",y=q[u.department_id]||"未知部门";return{...u,proxyUser:v,beProxyUser:d,deptName:y}})}else a.error(`获取代领列表失败：${n.res_msg}`)}catch{a.error("网络异常，获取代领列表失败")}},Bt=async()=>{if(!p.feeRecordId){a.warning("请选择稿费记录");return}if(!p.month){a.warning("请选择代领月份");return}if(!p.proxyUserId){a.warning("请选择代领人");return}if(!p.beProxyUserId){a.warning("请选择被代领人");return}if(!p.deptId){a.warning("请选择代领部门");return}const n=Number(p.amount);if(isNaN(n)||n<=0){a.warning("请输入有效的正数金额");return}try{const e={fee_record_id:p.feeRecordId,proxy_month:p.month,proxy_user_id:p.proxyUserId,original_user_id:p.beProxyUserId,department_id:q[p.deptId],fee_amount:p.amount},u=await me(e);u.res_code==="0000"?(a.success("代领设置成功"),p.month="",p.proxyUserId="",p.beProxyUserId="",p.deptId="",p.amount=0,await K()):a.error(`代领设置失败：${u.res_msg}`)}catch{a.error("网络异常，代领设置失败")}},Q=c(!1),i=F({proxy_id:"",proxy_user_id:"",original_user_id:"",department_id:"",proxy_month:"",fee_record_id:"",article_title:"",fee_amount:0,description:""}),qt=n=>{console.log("打开修改代领弹窗:",n),i.proxy_id=n.proxy_id,i.proxy_user_id=n.proxy_user_id,i.original_user_id=n.original_user_id,i.department_id=n.department_id,i.proxy_month=n.proxy_month,i.fee_record_id=n.fee_record_id,i.article_title=n.article_title||"",i.fee_amount=n.fee_amount||0,i.description=n.description||"",Q.value=!0},jt=async()=>{try{const n={};i.proxy_user_id&&(n.proxy_user_id=i.proxy_user_id),i.original_user_id&&(n.original_user_id=i.original_user_id),i.department_id&&(n.department_id=i.department_id),i.proxy_month&&(n.proxy_month=i.proxy_month),i.fee_record_id&&(n.fee_record_id=i.fee_record_id),i.article_title&&(n.article_title=i.article_title),i.fee_amount&&i.fee_amount>0&&(n.fee_amount=i.fee_amount),i.description&&(n.description=i.description),console.log("提交修改代领参数:",{proxyId:i.proxy_id,params:n});const e=await ve(i.proxy_id,n);e.res_code==="0000"?(a.success("修改代领记录成功"),Q.value=!1,await K()):a.error(`修改失败：${e.res_msg}`)}catch(n){console.error("修改代领记录异常:",n),a.error("网络异常，修改代领记录失败")}},zt=n=>{ae.confirm(`确认要撤销这条代领记录吗？<br>
    代领人：${n.proxyUser}<br>
    被代领人：${n.beProxyUser}<br>
    金额：${n.fee_amount}元`,"确认撤销",{confirmButtonText:"确认撤销",cancelButtonText:"取消",type:"warning",dangerouslyUseHTMLString:!0}).then(async()=>{await Ot(n.proxy_id)}).catch(()=>{})},Ot=async n=>{try{console.log("撤销代领记录:",n);const e=await Ft(n);e.res_code==="0000"?(a.success("撤销代领记录成功"),await K()):a.error(`撤销失败：${e.res_msg}`)}catch(e){console.error("撤销代领记录异常:",e),a.error("网络异常，撤销代领记录失败")}},Kt=async()=>{await st(),await Yt(),await K()};se(()=>{console.log("进入运营部，组件挂载，开始初始化数据"),Kt()});const at=c(!1),H=c(!1),C=F({userId:"",real_name:"",created_at:"",deptId:"operation"}),gt=async()=>{try{const n=await It();n.res_code==="0000"?V.value=n.data.list||[]:a.error(`获取人员列表失败：${n.res_msg}`)}catch{a.error("网络异常，获取人员列表失败")}},Qt=(n={})=>{H.value=!n.userId,C.userId=n.userId||"",C.real_name=n.real_name||"",C.created_at=n.created_at||"",C.deptId=n.deptId||"operation",at.value=!0},Ht=async()=>{if(!C.real_name||!C.created_at||!C.deptId){a.warning("请填写所有必填字段");return}try{const n=await re(C);n.res_code==="0000"?(a.success(H.value?"新增成员成功":"编辑成员成功"),at.value=!1,await gt()):a.error(`${H.value?"新增":"编辑"}成员失败：${n.res_msg}`)}catch{a.error(`网络异常，${H.value?"新增":"编辑"}成员失败`)}},Jt=async n=>{try{const e=await Ft(n);e.res_code==="0000"?(a.success("移除成员成功"),await gt()):a.error(`移除成员失败：${e.res_msg}`)}catch{a.error("网络异常，移除成员失败")}},rt=c(""),J=c(""),At=c([]),x=F({statistical_month:"",department_id:"",format:""}),Wt=()=>{const n=new Date().getFullYear(),e=n-5,u=n+1,v=[];for(let d=e;d<=u;d++)v.push(d);return v},Gt=()=>{J.value="",At.value=Array.from({length:12},(n,e)=>{const u=e+1;return{value:String(u).padStart(2,"0"),label:`${u}月`}})},Xt=()=>{rt.value&&J.value&&(x.statistical_month=`${rt.value}-${J.value}`,Zt())},$t=c([]),ut=c([]),W=c([]),it=et(()=>b($t.value.reduce((n,e)=>n+Number(e.totalAmount),0))),G=et(()=>b(ut.value.reduce((n,e)=>n+Number(e.totalAmount),0))),Ct=et(()=>b(Number(it.value)+Number(G.value))),Zt=async()=>{if(!x.statistical_month){a.warning("请选择统计月份（YYYY-MM）");return}try{const[n,e]=x.statistical_month.split("-"),u=`${n}-${e}-01`,v=new Date(Number(n),Number(e),0).toISOString().split("T")[0],d=await pe({startDate:u,endDate:v,department_id:x.department_id?Number(x.department_id):0});if(d.res_code==="0000"){const y=d.data.list||[];$t.value=y.filter(m=>m.department_id===1).map(m=>({...m,created_at:ie(m.created_at),real_names:Array.isArray(m.real_names)?m.real_names.join(", "):m.real_names,amountDetail:`稿费: ${b(m.fee_amount)}元`,totalAmount:m.fee_amount})),ut.value=y.filter(m=>m.department_id===2).map(m=>({...m,real_name:Array.isArray(m.real_names)?m.real_names.join(", "):m.real_names,amountDetail:`稿费: ${b(m.fee_amount)}元`,totalAmount:m.fee_amount})),te(y)}else a.error(`获取汇总数据失败：${d.res_msg}`)}catch(n){console.error("获取汇总数据失败:",n),a.error("网络异常，获取汇总数据失败")}},te=n=>{const e=new Map;n.forEach(u=>{const v=u.user_ids?.length||0;for(let d=0;d<v;d++){const y=u.user_ids[d],m=u.real_names[d]||"未知";e.has(y)||e.set(y,{userId:y,real_name:m,newsAmount:0,editAmount:0,bigImgAmount:0,totalAmount:0});const dt=e.get(y),Z=Number(u.fee_amount)/v;u.department_id===1&&(dt.newsAmount+=Z),u.department_id===2&&(dt.editAmount+=Z)}}),W.value=Array.from(e.values()).map(u=>({...u,newsAmount:b(u.newsAmount),editAmount:b(u.editAmount),bigImgAmount:b(u.bigImgAmount),totalAmount:b(u.newsAmount+u.editAmount+u.bigImgAmount)}))},ee=async()=>{if(!x.statistical_month){a.warning("请选择统计月份（YYYY-MM）");return}if(!x.department_id){a.warning("请选择部门ID");return}if(!x.format){a.warning("请选择导出格式（Excel/PDF）");return}try{const n={statistical_month:x.statistical_month,department_id:Number(x.department_id),format:x.format};console.log("导出接口请求参数：",n);const e=await ht(n);if(console.log(e),e.res_code==="0000"){const{fileUrl:u,recordCount:v,exportTime:d}=e.data;if(a.success(`导出成功！${d}，共${v}条记录`),u){const y=document.createElement("a");y.href=u,y.download=`稿费汇总_${x.statistical_month}.${x.format.toLowerCase()}`,y.click()}}else a.error(`导出失败：${e.res_msg}`)}catch(n){console.error("导出接口调用失败：",n),a.error("导出失败："+(n.response?.data?.res_msg||"网络异常"))}},X=F({month:""});c([]);const le=async()=>{if(!X.month){a.warning("请选择月份");return}const e=`${new Date().getFullYear()}-${X.month}`;try{a.loading({message:"导出中...",duration:0});const u=await ht({statistical_month:e,type:"proxy"});if(a.closeAll(),u.res_code==="0000"){const v=document.createElement("a");v.href=u.data.download_url,v.download=`代领调整后稿费_${e}.xlsx`,v.click(),a.success("导出成功")}else a.error(`导出失败：${u.res_msg}`)}catch(u){a.closeAll(),a.error("网络异常，导出失败"),console.error("做账数据导出失败：",u)}};return nt(),st(),(n,e)=>{const u=M("el-option"),v=M("el-select"),d=M("el-form-item"),y=M("el-input-number"),m=M("el-input"),dt=M("el-form"),Z=M("el-button"),ne=M("el-dialog");return s(),kt(ue,null,{"card-content":I(()=>[t("div",ge,[t("button",{class:N(["top-tab-btn",{active:$.value==="query"}]),onClick:e[0]||(e[0]=l=>j("query"))}," 任务查询 ",2),t("button",{class:N(["top-tab-btn",{active:$.value==="feedback"}]),onClick:e[1]||(e[1]=()=>{$.value="feedback",ot()})}," 查看反馈 ",2),t("button",{class:N(["top-tab-btn",{active:$.value==="manage"}]),onClick:e[2]||(e[2]=l=>j("manage"))}," 代领设置 ",2),t("button",{class:N(["top-tab-btn",{active:$.value==="user"}]),onClick:e[3]||(e[3]=l=>j("user"))}," 人员管理 ",2),t("button",{class:N(["top-tab-btn",{active:$.value==="summary"}]),onClick:e[4]||(e[4]=l=>j("summary"))}," 稿费汇总 ",2),t("button",{class:N(["top-tab-btn",{active:$.value==="account"}]),onClick:e[5]||(e[5]=l=>j("account"))}," 做账稿费 ",2)]),$.value==="query"?(s(),r("div",ke,[t("div",we,[e[46]||(e[46]=t("label",null,"选择月份:",-1)),_(t("select",{class:"form-select","onUpdate:modelValue":e[6]||(e[6]=l=>h.month=l)},[...e[44]||(e[44]=[t("option",{value:""},"全部",-1),t("option",{value:"01"},"1月",-1),t("option",{value:"02"},"2月",-1),t("option",{value:"03"},"3月",-1),t("option",{value:"04"},"4月",-1),t("option",{value:"05"},"5月",-1),t("option",{value:"06"},"6月",-1),t("option",{value:"07"},"7月",-1),t("option",{value:"08"},"8月",-1),t("option",{value:"09"},"9月",-1),t("option",{value:"10"},"10月",-1),t("option",{value:"11"},"11月",-1),t("option",{value:"12"},"12月",-1)])],512),[[U,h.month]]),e[47]||(e[47]=t("label",null,"选择部门:",-1)),_(t("select",{class:"form-select","onUpdate:modelValue":e[7]||(e[7]=l=>h.deptId=l)},[...e[45]||(e[45]=[t("option",{value:""},"全部",-1),t("option",{value:"news"},"新闻部",-1),t("option",{value:"edit"},"编辑部",-1),t("option",{value:"operation"},"运营部",-1)])],512),[[U,h.deptId]]),e[48]||(e[48]=t("label",null,"任务名称:",-1)),_(t("input",{type:"text",placeholder:"输入任务名称查询",class:"form-input","onUpdate:modelValue":e[8]||(e[8]=l=>h.article_title=l)},null,512),[[L,h.article_title]]),t("button",{class:"query-btn",onClick:nt},"查询")]),t("table",xe,[e[50]||(e[50]=t("thead",null,[t("tr",null,[t("th",null,"日期"),t("th",null,"任务名称"),t("th",null,"参与人"),t("th",null,"金额详情"),t("th",null,"部门")])],-1)),t("tbody",null,[pt.value.length===0?(s(),r("tr",Ue,[...e[49]||(e[49]=[t("td",{colspan:"5",class:"empty-tip"},"暂无任务记录",-1)])])):f("",!0),(s(!0),r(g,null,k(pt.value,l=>(s(),r("tr",{key:l.record_id},[t("td",null,o(l.created_at),1),t("td",null,o(l.article_title),1),t("td",null,o(l.real_names?.join(", ")||"-"),1),t("td",null,o(l.fee_amount),1),t("td",null,o(l.deptName),1)]))),128))])])])):f("",!0),$.value==="feedback"?(s(),r("div",De,[t("div",Ae,[e[53]||(e[53]=t("label",null,"反馈状态:",-1)),_(t("select",{class:"form-select","onUpdate:modelValue":e[9]||(e[9]=l=>ct.status=l)},[...e[51]||(e[51]=[t("option",{value:""},"全部",-1),t("option",{value:"pending"},"待处理",-1),t("option",{value:"replied"},"已回复",-1)])],512),[[U,ct.status]]),e[54]||(e[54]=t("label",null,"月份:",-1)),_(t("select",{class:"form-select","onUpdate:modelValue":e[10]||(e[10]=l=>R.value=l)},[...e[52]||(e[52]=[t("option",{value:""},"全部",-1),t("option",{value:"1"},"1月",-1)])],512),[[U,R.value]]),e[55]||(e[55]=t("label",null,"用户姓名:",-1)),_(t("input",{type:"text",placeholder:"输入姓名模糊查询",class:"form-input","onUpdate:modelValue":e[11]||(e[11]=l=>Y.value=l)},null,512),[[L,Y.value]]),t("button",{class:"query-btn",onClick:Mt},"查询")]),t("div",$e,[bt.value.length===0?(s(),r("div",Ce,"暂无反馈数据")):f("",!0),(s(!0),r(g,null,k(bt.value,l=>(s(),r("div",{class:"feedback-item",key:l.feedback_id},[t("div",Ie,[t("span",Ve,"反馈ID："+o(l.feedback_id),1),t("span",{class:N(["status-tag",w(be)[l.status]])},o(w(ye)[l.status]),3)]),t("div",he,[t("p",null,[e[56]||(e[56]=t("span",{class:"label"},"反馈用户：",-1)),E(o(l.real_name),1)]),t("p",null,[e[57]||(e[57]=t("span",{class:"label"},"反馈内容：",-1)),E(o(l.content),1)]),t("p",null,[e[58]||(e[58]=t("span",{class:"label"},"反馈时间：",-1)),E(o(l.created_at),1)]),t("p",null,[e[59]||(e[59]=t("span",{class:"label"},"回复时间：",-1)),E(o(l.replied_at||"未回复"),1)]),t("p",null,[e[60]||(e[60]=t("span",{class:"label"},"回复内容：",-1)),E(o(l.reply_content||"暂无回复"),1)])]),t("div",Fe,[t("button",{class:"op-btn reply-btn",onClick:tt=>Et(l.feedback_id)},"回复",8,Pe),t("button",{class:"op-btn status-btn",onClick:tt=>Tt(l.feedback_id)},"改状态",8,Se)])]))),128))]),bt.value.length>0?(s(),r("div",Le,[t("button",{class:"page-btn",onClick:e[12]||(e[12]=l=>wt(P.value-1)),disabled:P.value<=1}," 上一页 ",8,Me),t("span",null,"第"+o(P.value)+"页 / 共"+o(yt.value)+"页",1),t("button",{class:"page-btn",onClick:e[13]||(e[13]=l=>wt(P.value+1)),disabled:P.value>=yt.value}," 下一页 ",8,Ee)])):f("",!0),_t.value?(s(),r("div",Ne,[t("div",Te,[t("h4",null,"回复反馈（ID: "+o(S.value)+"）",1),_(t("textarea",{placeholder:"请输入回复内容",class:"reply-textarea","onUpdate:modelValue":e[14]||(e[14]=l=>B.reply_content=l)},null,512),[[L,B.reply_content]]),t("div",{class:"dialog-btns"},[t("button",{class:"cancel-btn",onClick:xt},"取消"),t("button",{class:"confirm-btn",onClick:Nt},"提交回复")])])])):f("",!0),ft.value?(s(),r("div",Re,[t("div",Ye,[t("h4",null,"更新反馈状态（ID: "+o(S.value)+"）",1),_(t("select",{class:"form-select","onUpdate:modelValue":e[15]||(e[15]=l=>z.status=l)},[...e[61]||(e[61]=[t("option",{value:"pending"},"待处理",-1),t("option",{value:"replied"},"已回复",-1)])],512),[[U,z.status]]),t("div",{class:"dialog-btns"},[t("button",{class:"cancel-btn",onClick:Ut},"取消"),t("button",{class:"confirm-btn",onClick:Rt},"确认更新")])])])):f("",!0)])):f("",!0),$.value==="manage"?(s(),r("div",Be,[e[78]||(e[78]=t("div",{class:"section-title"},[t("div",{class:"title-line"}),t("h3",null,"代领设置")],-1)),t("div",qe,[t("div",je,[e[63]||(e[63]=t("label",null,"选择月份:",-1)),_(t("select",{class:"form-select","onUpdate:modelValue":e[16]||(e[16]=l=>p.month=l)},[...e[62]||(e[62]=[t("option",{value:""},"请选择",-1),t("option",{value:"01"},"1月",-1),t("option",{value:"02"},"2月",-1),t("option",{value:"03"},"3月",-1),t("option",{value:"04"},"4月",-1),t("option",{value:"05"},"5月",-1),t("option",{value:"06"},"6月",-1),t("option",{value:"07"},"7月",-1),t("option",{value:"08"},"8月",-1),t("option",{value:"09"},"9月",-1),t("option",{value:"10"},"10月",-1),t("option",{value:"11"},"11月",-1),t("option",{value:"12"},"12月",-1)])],512),[[U,p.month]])]),t("div",ze,[e[65]||(e[65]=t("label",null,"稿费记录:",-1)),_(t("select",{class:"form-select","onUpdate:modelValue":e[17]||(e[17]=l=>p.feeRecordId=l)},[e[64]||(e[64]=t("option",{value:""},"请选择稿费记录",-1)),(s(!0),r(g,null,k(Dt.value,l=>(s(),r("option",{key:l.record_id,value:l.record_id},o(l.fee_record_id)+" - "+o(l.real_names[0]||"未知用户")+" - "+o(l.fee_amount)+"元 - "+o(l.month)+"月 ",9,Oe))),128))],512),[[U,p.feeRecordId]])]),t("div",Ke,[e[67]||(e[67]=t("label",null,"代领人:",-1)),_(t("select",{class:"form-input","onUpdate:modelValue":e[18]||(e[18]=l=>p.proxyUserId=l)},[e[66]||(e[66]=t("option",{value:""},"请选择代领人",-1)),(s(!0),r(g,null,k(V.value,l=>(s(),r("option",{key:l.user_id,value:l.user_id},o(l.real_name),9,Qe))),128))],512),[[U,p.proxyUserId]])]),t("div",He,[e[69]||(e[69]=t("label",null,"被代领人:",-1)),_(t("select",{class:"form-input","onUpdate:modelValue":e[19]||(e[19]=l=>p.beProxyUserId=l)},[e[68]||(e[68]=t("option",{value:""},"请选择被代领人",-1)),(s(!0),r(g,null,k(V.value,l=>(s(),r("option",{key:l.user_id,value:l.user_id},o(l.real_name),9,Je))),128))],512),[[U,p.beProxyUserId]])]),t("div",We,[e[71]||(e[71]=t("label",null,"选择部门:",-1)),_(t("select",{class:"form-input small-input","onUpdate:modelValue":e[20]||(e[20]=l=>p.deptId=l)},[...e[70]||(e[70]=[t("option",{value:""},"请选择",-1),t("option",{value:"news"},"新闻部",-1),t("option",{value:"edit"},"编辑部",-1)])],512),[[U,p.deptId]])]),t("div",Ge,[e[72]||(e[72]=t("label",null,"金额:",-1)),_(t("input",{type:"number",step:"1.00",placeholder:"输入",class:"form-input tiny-input","onUpdate:modelValue":e[21]||(e[21]=l=>p.amount=l)},null,512),[[L,p.amount]]),e[73]||(e[73]=E("元 ",-1))]),t("button",{class:"confirm-btn",onClick:Bt},"确认代领")]),e[79]||(e[79]=t("div",{class:"section-title"},[t("div",{class:"title-line"}),t("h3",null,"当前代领")],-1)),t("table",Xe,[e[77]||(e[77]=t("thead",null,[t("tr",null,[t("th",null,"代领人"),t("th",null,"被代领人"),t("th",null,"部门"),t("th",null,"金额"),t("th",null,"操作")])],-1)),t("tbody",null,[O.value.length===0?(s(),r("tr",Ze,[...e[74]||(e[74]=[t("td",{colspan:"5",class:"empty-tip"},"暂无代领记录",-1)])])):f("",!0),(s(!0),r(g,null,k(O.value,l=>(s(),r("tr",{key:l.proxy_id},[t("td",null,o(l.proxyUser),1),t("td",null,o(l.beProxyUser),1),t("td",null,o(l.deptName),1),t("td",null,o(l.fee_amount),1),t("td",null,[t("button",{class:"op-btn",onClick:tt=>qt(l)},"修改",8,tl),t("button",{class:"op-btn danger",onClick:tt=>zt(l)},"撤销",8,el)])]))),128))]),D(ne,{modelValue:Q.value,"onUpdate:modelValue":e[28]||(e[28]=l=>Q.value=l),title:"修改代领记录",width:"500px"},{footer:I(()=>[t("span",ll,[D(Z,{onClick:e[27]||(e[27]=l=>Q.value=!1)},{default:I(()=>[...e[75]||(e[75]=[E("取消",-1)])]),_:1}),D(Z,{type:"primary",onClick:jt},{default:I(()=>[...e[76]||(e[76]=[E("确定修改",-1)])]),_:1})])]),default:I(()=>[D(dt,{model:i,"label-width":"100px"},{default:I(()=>[D(d,{label:"代领人"},{default:I(()=>[D(v,{modelValue:i.proxy_user_id,"onUpdate:modelValue":e[22]||(e[22]=l=>i.proxy_user_id=l),placeholder:"请选择代领人"},{default:I(()=>[(s(!0),r(g,null,k(V.value,l=>(s(),kt(u,{key:l.user_id,label:l.real_name,value:l.user_id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),D(d,{label:"被代领人"},{default:I(()=>[D(v,{modelValue:i.original_user_id,"onUpdate:modelValue":e[23]||(e[23]=l=>i.original_user_id=l),placeholder:"请选择被代领人"},{default:I(()=>[(s(!0),r(g,null,k(V.value,l=>(s(),kt(u,{key:l.user_id,label:l.real_name,value:l.user_id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),D(d,{label:"部门"},{default:I(()=>[D(v,{modelValue:i.department_id,"onUpdate:modelValue":e[24]||(e[24]=l=>i.department_id=l),placeholder:"请选择部门"},{default:I(()=>[D(u,{label:"新闻部",value:1}),D(u,{label:"编辑部",value:2}),D(u,{label:"运营部",value:3})]),_:1},8,["modelValue"])]),_:1}),D(d,{label:"金额"},{default:I(()=>[D(y,{modelValue:i.fee_amount,"onUpdate:modelValue":e[25]||(e[25]=l=>i.fee_amount=l),min:0,precision:2,placeholder:"请输入金额"},null,8,["modelValue"])]),_:1}),D(d,{label:"备注"},{default:I(()=>[D(m,{modelValue:i.description,"onUpdate:modelValue":e[26]||(e[26]=l=>i.description=l),type:"textarea",rows:3,placeholder:"请输入备注信息"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])])):f("",!0),$.value==="user"?(s(),r("div",nl,[e[86]||(e[86]=t("div",{class:"section-title"},[t("div",{class:"title-line"}),t("h3",null,"目前成员")],-1)),t("table",ol,[e[81]||(e[81]=t("thead",null,[t("tr",null,[t("th",null,"用户ID"),t("th",null,"真实姓名"),t("th",null,"学号"),t("th",null,"邮箱"),t("th",null,"角色"),t("th",null,"操作")])],-1)),t("tbody",null,[V.value.length===0?(s(),r("tr",sl,[...e[80]||(e[80]=[t("td",{colspan:"6",class:"empty-tip"},"暂无成员记录",-1)])])):f("",!0),(s(!0),r(g,null,k(V.value,l=>(s(),r("tr",{key:l.user_id},[t("td",null,o(l.user_id),1),t("td",null,o(l.real_name),1),t("td",null,o(l.student_number),1),t("td",null,o(l.email),1),t("td",null,o(l.role),1),t("td",null,[t("button",{class:"op-btn",onClick:tt=>Qt(l)},"编辑",8,al),t("button",{class:"op-btn danger",onClick:tt=>Jt(l.user_id)},"移除",8,rl)])]))),128))])]),at.value?(s(),r("div",ul,[t("div",il,[t("h4",null,o(H.value?"新增成员":"编辑成员"),1),t("div",dl,[e[82]||(e[82]=t("label",null,"成员名称:",-1)),_(t("input",{type:"text",class:"form-input","onUpdate:modelValue":e[29]||(e[29]=l=>C.real_name=l)},null,512),[[L,C.real_name]])]),t("div",pl,[e[83]||(e[83]=t("label",null,"加入时间:",-1)),_(t("input",{type:"date",class:"form-input","onUpdate:modelValue":e[30]||(e[30]=l=>C.created_at=l)},null,512),[[L,C.created_at]])]),t("div",ml,[e[85]||(e[85]=t("label",null,"部门:",-1)),_(t("select",{class:"form-input","onUpdate:modelValue":e[31]||(e[31]=l=>C.deptId=l)},[...e[84]||(e[84]=[t("option",{value:"news"},"新闻部",-1),t("option",{value:"edit"},"编辑部",-1),t("option",{value:"operation"},"运营部",-1)])],512),[[U,C.deptId]])]),t("div",vl,[t("button",{class:"cancel-btn",onClick:e[32]||(e[32]=l=>at.value=!1)},"取消"),t("button",{class:"confirm-btn",onClick:Ht},"确认")])])])):f("",!0)])):f("",!0),$.value==="summary"?(s(),r("div",cl,[e[108]||(e[108]=t("div",{class:"section-title"},[t("div",{class:"title-line"}),t("h3",null,"稿费汇总与导出")],-1)),t("div",_l,[t("div",fl,[e[89]||(e[89]=t("label",null,"统计月份:",-1)),_(t("select",{class:"form-select","onUpdate:modelValue":e[33]||(e[33]=l=>rt.value=l),onChange:Gt},[e[87]||(e[87]=t("option",{value:""},"请选择年份",-1)),(s(!0),r(g,null,k(Wt(),l=>(s(),r("option",{key:l,value:l},o(l)+"年 ",9,bl))),128))],544),[[U,rt.value]]),_(t("select",{class:"form-select","onUpdate:modelValue":e[34]||(e[34]=l=>J.value=l),onChange:Xt},[e[88]||(e[88]=t("option",{value:""},"请选择月份",-1)),(s(!0),r(g,null,k(At.value,l=>(s(),r("option",{key:l.value,value:l.value},o(l.label),9,yl))),128))],544),[[U,J.value]])]),t("div",gl,[e[91]||(e[91]=t("label",null,"部门ID:",-1)),_(t("select",{class:"form-select","onUpdate:modelValue":e[35]||(e[35]=l=>x.department_id=l)},[...e[90]||(e[90]=[t("option",{value:""},"请选择部门",-1),t("option",{value:"1"},"新闻部（ID:1）",-1),t("option",{value:"2"},"编辑部（ID:2）",-1),t("option",{value:"3"},"运营部（ID:3）",-1)])],512),[[U,x.department_id]])]),t("div",kl,[e[93]||(e[93]=t("label",null,"导出格式:",-1)),_(t("select",{class:"form-select","onUpdate:modelValue":e[36]||(e[36]=l=>x.format=l)},[...e[92]||(e[92]=[t("option",{value:""},"请选择格式",-1),t("option",{value:"Excel"},"Excel",-1),t("option",{value:"PDF"},"PDF",-1)])],512),[[U,x.format]])]),t("button",{class:"export-btn",onClick:ee},"导出数据")]),t("div",wl,[e[97]||(e[97]=t("label",null,"稿费汇总:",-1)),t("table",xl,[e[95]||(e[95]=t("thead",null,[t("tr",null,[t("th",null,"姓名"),t("th",null,"新闻部稿费"),t("th",null,"编辑部稿费"),t("th",null,"大图稿费"),t("th",null,"总金额")])],-1)),t("tbody",null,[W.value.length===0?(s(),r("tr",Ul,[...e[94]||(e[94]=[t("td",{colspan:"5",class:"empty-tip"},"暂无汇总数据",-1)])])):f("",!0),(s(!0),r(g,null,k(W.value,l=>(s(),r("tr",{key:l.userId},[t("td",null,o(l.real_name),1),t("td",null,o(l.newsAmount)+"元",1),t("td",null,o(l.editAmount)+"元",1),t("td",null,o(l.bigImgAmount)+"元",1),t("td",null,o(l.totalAmount)+"元",1)]))),128))])]),t("div",Dl,[e[96]||(e[96]=t("label",null,"平台总稿费:",-1)),t("span",null,o(Ct.value)+"元",1)])]),t("div",Al,[e[101]||(e[101]=t("label",null,"编辑部:",-1)),t("table",$l,[e[99]||(e[99]=t("thead",null,[t("tr",null,[t("th",null,"项目"),t("th",null,"供图人"),t("th",null,"金额详情"),t("th",null,"任务总金额")])],-1)),t("tbody",null,[ut.value.length===0?(s(),r("tr",Cl,[...e[98]||(e[98]=[t("td",{colspan:"4",class:"empty-tip"},"暂无编辑部稿费记录",-1)])])):f("",!0),(s(!0),r(g,null,k(ut.value,l=>(s(),r("tr",{key:l.projectId},[t("td",null,o(l.article_title),1),t("td",null,o(l.real_name),1),t("td",null,o(l.amountDetail),1),t("td",null,o(l.totalAmount)+"元",1)]))),128))])]),t("div",Il,[e[100]||(e[100]=t("label",null,"编辑部总:",-1)),t("span",null,o(G.value)+"元",1)])]),t("div",Vl,[e[107]||(e[107]=t("label",null,"稿费汇总:",-1)),t("table",hl,[e[103]||(e[103]=t("thead",null,[t("tr",null,[t("th",null,"姓名"),t("th",null,"新闻部稿费"),t("th",null,"编辑部稿费"),t("th",null,"大图稿费"),t("th",null,"总金额")])],-1)),t("tbody",null,[W.value.length===0?(s(),r("tr",Fl,[...e[102]||(e[102]=[t("td",{colspan:"5",class:"empty-tip"},"暂无汇总数据",-1)])])):f("",!0),(s(!0),r(g,null,k(W.value,l=>(s(),r("tr",{key:l.userId},[t("td",null,o(l.real_name),1),t("td",null,o(l.newsAmount)+"元",1),t("td",null,o(l.editAmount)+"元",1),t("td",null,o(l.bigImgAmount)+"元",1),t("td",null,o(l.totalAmount)+"元",1)]))),128))])]),t("div",Pl,[e[104]||(e[104]=t("label",null,"新闻部总:",-1)),t("span",null,o(it.value)+"元",1)]),t("div",Sl,[e[105]||(e[105]=t("label",null,"编辑部总:",-1)),t("span",null,o(G.value)+"元",1)]),t("div",Ll,[e[106]||(e[106]=t("label",null,"平台总稿费:",-1)),t("span",null,o(Ct.value)+"元",1)])])])):f("",!0),$.value==="account"?(s(),r("div",Ml,[e[122]||(e[122]=t("div",{class:"section-title"},[t("div",{class:"title-line"}),t("h3",null,"代领调整后稿费")],-1)),t("div",El,[e[110]||(e[110]=t("label",null,"选择月份:",-1)),_(t("select",{class:"form-select","onUpdate:modelValue":e[37]||(e[37]=l=>X.month=l),onChange:e[38]||(e[38]=(...l)=>n.fetchAllAccountData&&n.fetchAllAccountData(...l))},[...e[109]||(e[109]=[t("option",{value:""},"请选择",-1),t("option",{value:"01"},"1月",-1),t("option",{value:"02"},"2月",-1),t("option",{value:"03"},"3月",-1),t("option",{value:"04"},"4月",-1),t("option",{value:"05"},"5月",-1),t("option",{value:"06"},"6月",-1),t("option",{value:"07"},"7月",-1),t("option",{value:"08"},"8月",-1),t("option",{value:"09"},"9月",-1),t("option",{value:"10"},"10月",-1),t("option",{value:"11"},"11月",-1),t("option",{value:"12"},"12月",-1)])],544),[[U,X.month]]),t("button",{class:"export-btn",onClick:le,disabled:!X.month}," 导出本月做账数据 ",8,Nl)]),t("table",Tl,[e[112]||(e[112]=t("thead",null,[t("tr",null,[t("th",null,"代领人"),t("th",null,"被代领人"),t("th",null,"代领部门"),t("th",null,"代领金额"),t("th",null,"最终金额")])],-1)),t("tbody",null,[O.value.length===0?(s(),r("tr",Rl,[...e[111]||(e[111]=[t("td",{colspan:"5",class:"empty-tip"},"暂无代领记录数据",-1)])])):f("",!0),(s(!0),r(g,null,k(O.value,l=>(s(),r("tr",{key:l.proxy_id},[t("td",null,o(l.proxy_user_name),1),t("td",null,o(l.original_user_name),1),t("td",null,o(l.department_name),1),t("td",null,o(w(b)(l.fee_amount)),1),t("td",null,o(w(b)(l.final_fee_amount)),1)]))),128))])]),e[123]||(e[123]=t("div",{class:"section-title mt-20"},[t("div",{class:"title-line"}),t("h3",null,"新闻部代领后")],-1)),t("table",Yl,[e[115]||(e[115]=t("thead",null,[t("tr",null,[t("th",null,"日期"),t("th",null,"任务名称"),t("th",null,"拍摄人员"),t("th",null,"任务金额"),t("th",null,"总金额")])],-1)),t("tbody",null,[n.newsDeptList.length===0?(s(),r("tr",Bl,[...e[113]||(e[113]=[t("td",{colspan:"5",class:"empty-tip"},"暂无新闻部代领后数据",-1)])])):f("",!0),(s(!0),r(g,null,k(n.newsDeptList,l=>(s(),r("tr",{key:l.record_id},[t("td",null,o(n.formatDate(l.created_at)),1),t("td",null,o(l.article_title),1),t("td",null,o(l.real_names.join(", ")),1),t("td",null,o(w(b)(l.fee_amount)),1),t("td",null,o(w(b)(it.value)),1)]))),128))]),n.newsDeptList.length>0?(s(),r("tfoot",ql,[t("tr",jl,[e[114]||(e[114]=t("td",{colspan:"4",align:"right"},"新闻部总计：",-1)),t("td",null,o(w(b)(it.value)),1)])])):f("",!0)]),e[124]||(e[124]=t("div",{class:"section-title mt-20"},[t("div",{class:"title-line"}),t("h3",null,"编辑部代领后")],-1)),t("table",zl,[e[118]||(e[118]=t("thead",null,[t("tr",null,[t("th",null,"项目"),t("th",null,"供图人"),t("th",null,"金额详情"),t("th",null,"总金额")])],-1)),t("tbody",null,[n.editDeptList.length===0?(s(),r("tr",Ol,[...e[116]||(e[116]=[t("td",{colspan:"4",class:"empty-tip"},"暂无编辑部代领后数据",-1)])])):f("",!0),(s(!0),r(g,null,k(n.editDeptList,l=>(s(),r("tr",{key:l.record_id},[t("td",null,o(l.article_title),1),t("td",null,o(l.real_names.join(", ")),1),t("td",null,o(w(b)(l.fee_amount)),1),t("td",null,o(w(b)(G.value)),1)]))),128))]),n.editDeptList.length>0?(s(),r("tfoot",Kl,[t("tr",Ql,[e[117]||(e[117]=t("td",{colspan:"3",align:"right"},"编辑部总计：",-1)),t("td",null,o(w(b)(G.value)),1)])])):f("",!0)]),e[125]||(e[125]=t("div",{class:"section-title mt-20"},[t("div",{class:"title-line"}),t("h3",null,"稿费代领后汇总")],-1)),t("table",Hl,[e[121]||(e[121]=t("thead",null,[t("tr",null,[t("th",null,"姓名"),t("th",null,"新闻部稿费"),t("th",null,"编辑部稿费"),t("th",null,"大图稿费"),t("th",null,"总金额")])],-1)),t("tbody",null,[n.summaryList.length===0?(s(),r("tr",Jl,[...e[119]||(e[119]=[t("td",{colspan:"5",class:"empty-tip"},"暂无稿费汇总数据",-1)])])):f("",!0),(s(!0),r(g,null,k(n.summaryList,l=>(s(),r("tr",{key:l.user_name},[t("td",null,o(l.user_name),1),t("td",null,o(w(b)(l.news_fee)),1),t("td",null,o(w(b)(l.edit_fee)),1),t("td",null,o(w(b)(l.big_img_fee)),1),t("td",null,o(w(b)(l.total_fee)),1)]))),128))]),n.summaryList.length>0?(s(),r("tfoot",Wl,[t("tr",Gl,[e[120]||(e[120]=t("td",{colspan:"1",align:"right"},"平台总计：",-1)),t("td",null,o(w(b)(n.totalNewsFee)),1),t("td",null,o(w(b)(n.totalEditFee)),1),t("td",null,o(w(b)(n.totalBigImgFee)),1),t("td",null,o(w(b)(n.totalAllFee)),1)])])):f("",!0)])])):f("",!0),mt.value?(s(),r("div",Xl,[t("div",Zl,[t("h4",null,o(lt.value?"新增任务":"编辑任务"),1),t("div",tn,[e[126]||(e[126]=t("label",null,"日期:",-1)),_(t("input",{type:"date",class:"form-input","onUpdate:modelValue":e[39]||(e[39]=l=>A.created_at=l)},null,512),[[L,A.created_at]])]),t("div",en,[e[127]||(e[127]=t("label",null,"任务名称:",-1)),_(t("input",{type:"text",class:"form-input","onUpdate:modelValue":e[40]||(e[40]=l=>A.article_title=l)},null,512),[[L,A.article_title]])]),t("div",ln,[e[128]||(e[128]=t("label",null,"参与人及金额:",-1)),_(t("input",{type:"text",class:"form-input","onUpdate:modelValue":e[41]||(e[41]=l=>A.userAmountDetail=l),placeholder:"如：张三(100),李四(200)"},null,512),[[L,A.userAmountDetail]])]),t("div",nn,[e[130]||(e[130]=t("label",null,"部门:",-1)),_(t("select",{class:"form-input","onUpdate:modelValue":e[42]||(e[42]=l=>A.deptId=l)},[...e[129]||(e[129]=[t("option",{value:"news"},"新闻部",-1),t("option",{value:"edit"},"编辑部",-1)])],512),[[U,A.deptId]])]),t("div",on,[t("button",{class:"cancel-btn",onClick:e[43]||(e[43]=l=>mt.value=!1)},"取消"),t("button",{class:"confirm-btn",onClick:St},"确认")])])])):f("",!0)]),_:1})}}},_n=oe(sn,[["__scopeId","data-v-1cc48783"]]);export{_n as default};
